Cell Marker list


第一次分群: 
    immune (CD45+, PTPRC),
    epithelial/cancer (EpCAM+, EPCAM),
    stromal (CD10+, MME, fibo or CD31+, PECAM1, endo)

接着 非负矩阵


BMMC(bone marrow mononuclear cell) 骨髓单个核细胞：是包括单核细胞，淋巴细胞，造血干细胞和祖细胞在内的具有单个核的细胞混合群体（无红细胞和粒细胞）

PBMC(peripheral blood mononuclear cell) 外周血单个核细胞:注意这里是 mononuclear cell单个核细胞，而不是Monocyte单核细胞,是指任何拥有圆形的细胞核的外周血细胞，这些细胞包括淋巴细胞（T细胞、B细胞、NK细胞）和单核细胞，而红血球和血小板由于没有细胞核不属于此类，粒细胞（包括中性粒细胞, 嗜碱性粒细胞和嗜酸性粒细胞）拥有多分叶的核，也不属于此类




========================================
查基因和细胞的数据库
----------------------------------------

1. 查基因的意义，基因的曾用名
https://www.genecards.org/cgi-bin/carddisp.pl?gene=IL2RA&keywords=IL2RA
Receptor for interleukin-2. The receptor is involved in the regulation of immune tolerance by controlling regulatory T cells (TREGs) activity. TREGs suppress the activation and expansion of autoreactive T-cells.


(2) 查人的的基因
https://www.genenames.org/



2. 查基因的表达位置，有抗体染色切片证据
https://www.proteinatlas.org/ENSG00000203747-FCGR3A/cell
https://www.proteinatlas.org/ENSG00000109083-IFT20/cell 细胞骨架
https://www.proteinatlas.org/ENSG00000177606-JUN/cell 核内




3. 细胞类型标记物 数据库

CellMarker：http://biocc.hrbmu.edu.cn/CellMarker/index.jsp
PanglaoDB：https://panglaodb.se/index.html


商业抗体公司整理的信息
https://www.cellsignal.com/pathways/immune-cell-markers-mouse
https://www.cellsignal.cn/pathways/immune-cell-markers-mouse

https://assets.thermofisher.com/TFS-Assets/BID/Product-Information/Immuno-cell-guide-zh.pdf

https://www.abcam.cn/primary-antibodies/human-cd-antigen-guide-2








========================================
*** 文献细胞分类细节 ***
----------------------------------------

研究人员首先使用10x及Smart-seq2两种技术对从结直肠癌患者中收集的免疫和非免疫细胞进行单细胞转录组测序，从中鉴定出包括T细胞、B细胞、先天性淋巴细胞（Innate lymphoid cell, ILC）、髓系细胞、上皮细胞、成纤维细胞等主要细胞类群及下属的40个CD45+的免疫细胞类群和12个CD45-的非免疫细胞类群（图1）。


========================================
鼻咽癌细胞癌: nasopharyngeal carcinoma
----------------------------------------

1. 鼻咽癌细胞分类
# https://www.nature.com/articles/s41422-020-0374-x

We then annotated the clusters by the average expression of curated gene sets of the following major cell types:
- epithelial cells (EPCAM, KRT19, KRT18, KRT5, and KRT15),
- myeloid cells (LYZ, CD68, MS4A6A, CD1E, IL3RA, and LAMP3),
- T cells (CD2 and CD3D/E/G),
- B cells (CD79A/B, CD19, and MS4A1),
- and CAFs (COL1A1, COL3A1, and DCN).


(2) Novel myeloid cell subtypes and regulators underlying monocyte-macrophage differentiation in NPC
In total, 5191 myeloid cells were clustered into six separate subsets (Fig. 3a):
macrophages, monocytes, pDCs, CLEC9A+ DCs (DC1), CD1C+ DCs (DC2), and CCR7+ DCs (DC3) (Fig. 3b).

- Notably, DC1 expressed many of the classic markers of conventional type 1 DCs (cDC1),
	* including CLEC9A, IRF8, and IDO1 (Fig. 3c).
	* cDC1 constitute the key DC subtype responsible for cross-priming antitumor CD8+ T cells and are critical in antitumor immunity.

- DC3 expressed markers, such as CCR7, LAMP3, FSCN1, and CCL19, that have been associated with DC activation.
	* Of these markers, CCL19 is known to attract naïve T cells as well as other DCs by interacting with CCR7 (Fig. 3c).

- DC2 preferentially expressed a series of classic marker genes of conventional type 2 DCs (cDC2), including CD1E, FCER1A and CLEC10A (Fig. 3c).


(3)
Of these clusters, one consisted of rarely reported FCRL4+ memory B cells, in which elevated CCR1 expression supports the homing of these cells to inflamed tissues.






========================================
PBMC 细胞类型 marker: 血液
----------------------------------------
1. [2020]Single-Cell Analyses Identify Dysfunctional CD16+ CD8 T Cells in Smokers
BPMC markers: https://www.sciencedirect.com/science/article/pii/S2666379120300707

Cells in clusters expressing CD3D as a positive marker were designated as T cells
	- T cells were further classified into CD4 T cells, CD8 T cells, or NKT cells based on the expression of CD4, CD8A, or NCR3;

NK cells were identified based on CD3D as a negative marker combined with the expression of NKG7, GNLY, GZMB, PRF1, and NCR3 as positive markers.

Monocytes were positive for LYZ and either CD14 or FCGR3A (encodes CD16), characteristic of classical or nonclassical monocytes.

DCs were similar to monocytes but could be distinguished by the expression of FCER1A.

B cells were defined by MS4A1 (encodes CD20): CD79A, CD79B;



2. []Single-cell transcriptomics of human T cells reveals tissue and activation signatures in health and disease
https://www.nature.com/articles/s41467-019-12464-3




3. [2019]Single-cell RNA sequencing unveils the shared and the distinct cytotoxic hallmarks of human TCRVδ1 and TCRVδ2 γδ T lymphocytes

https://www.pnas.org/content/pnas/116/24/11906.full.pdf




4. PBMC 分为13个亚群
Nucleic Acids Res. 2018 Apr ，dropClust: efficient clustering of ultra-large scRNA-seq data
https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&mid=2247486271&idx=1&sn=638b434b6deee63206af1c0eeda175ab

Naive T cells: CD27, CCR7, CD8A, CD8B;
CD4+ memory cells: IL7R, CD27, CCR7;
NKT cells: ZNF683, CD8A, CD8B
B cells: CD79A, CD37;
CD8+ T cells: GZMK, CD8A, CD8B;
NK cells: CD160, NKG7, GNLY, CD247, CCL3, GZMB;
CD16+ and CD14+ monocytes: CD68, CD16(FCGR3A), CD14, S100A12;
Regulatory T cells: CCR10, CD25(IL2RA), CD52, CMTM7, FOXP3;
Monocyte derived dendritic cells: CST3, CD1C, FCER1A;
Megakaryocyte progenitors: PF4, PPBP, PLA2G12A;
Progenitor-NK cells: ID2;
Plasmacytoid dendritic cells: GZMB, CD123(IL3RA);




### gene study

# TNFRSF4 Gene (OX40)
Receptor for TNFSF4/OX40L/GP34. Is a costimulatory molecule implicated in long-term T-cell immunity.

Knockout studies in mice suggested that this receptor promotes the expression of apoptosis inhibitors BCL2 and BCL2lL1/BCL2-XL, and thus suppresses apoptosis.
The knockout studies also suggested the roles of this receptor in CD4+ T cell response, as well as in T cell-dependent B cell proliferation and differentiation.
在CD4+ T-cell细胞响应中，在T细胞依赖的B细胞分裂和分化中起作用。




4. PBMC markers in a png
https://onek1k.org/cell-types
from https://pubmed.ncbi.nlm.nih.gov/35389779/
  Single-cell eQTL mapping identifies cell type-specific genetic control of autoimmune disease




5.




========================================
BMMC 细胞类型 marker: 骨髓
----------------------------------------
1. human
pre_B	 VPREB1	 VPREB3
pro_B	 CD79A	 CD79B
B_cell_related_genes	 MS4A1	 IGHD	 CD19	 IGKC
pro_NK_T	 NKG7	 DNTT	 ACY3	 MLXIP
pro_megakaryocyte	 ITGA2B	 CD41	 CD9	 PF4	 PPBP	 PLEK
pro_basophil	 GATA2	 LMO4	 MS4A2	 TPSB2	 RNF130
CD34_p_erythrocyte_progenitors	 GATA1	 KLF1	 MYC	 TFRC	 CD71	 HBB	 HBD
pro_eosinophil	 PGR2	 RNase2	 EDN	 RNase3	 ECP	 CST7	 CEBPE	 CSF3R	 CD114	 CD177	 S100A9	 S100A8	 S100P
pro_neutrophil	 RNase2	 EDN	 RNase3	 ECP	 CST7	 CEBPE	 CSF3R	 CD114	 CD177	 S100A9	 S100A8	 S100P
pro_monocyte	 LYZ	 CD14	 CSF1R	 MS4A7	 FCN1	 MNDA
pro_dendritic	 CD74	 STAT1	 ID2	 IRF8	 HLA-DRB	 HLA-DRA	 HLA-DPA	 HLA-DPB	 HLA-DQ
pro_Langerhans_dendritic	 CXCL2
cell_cycle	 TK1	 PCNA
HSPC	  CD34	 SPINK2	 SOX4
granulocyte	 MPO
mature_NK	 GZMH	 GZMA	 GZMB
T_cell	 CD3	 CD8	 CXCR4	 CD69


(2) from paper: bone marrow mononuclear cells (BMMCs)
https://www.nature.com/articles/s41421-020-00223-4 QinPengfei

1.39% HSPCs (AVP and CD34), 
10.15% erythroid progenitor cells (EPCs) (GYPA and KLF1), 
0.08% megakaryocytes (Mk) (PF4 and GP9), 
1.25% myelocytes (ELANE and MPO), 
2.91% monocytes (LYZ and CD14), 
17.67% B cells (CD79A), 
53.11% T cells (CD3D), 
11.62% natural killer cells (NK) (FCGR3A and NCAM1), 
0.04% stromal cells (CXCL12 and COL6A1).


myelocyte [ˈmaɪələʊsaɪt] n. [组织] 髓细胞；[细胞] 中幼粒细胞
megakaryocyte [ˌmeɡəˈkærɪəˌsaɪt] n. [组织] 巨核细胞








2. mouse
mouse: Hba-a1, Hba-a2, Hbb-bt
pro_basophil	 Prss34










========================================
人体肠道 (Cells of the human intestinal tract mapped across space and time)
----------------------------------------

https://www.nature.com/articles/s41586-021-03852-1/figures/6














========================================
*** leucocyte 白细胞(CD45+)分化路径 ***
----------------------------------------
==> for mouse https://www.cellsignal.com/pathways/immune-cell-markers-mouse
==> for human https://www.cellsignal.com/pathways/immune-cell-markers-human
leucocyte 白细胞(CD45+)
    髓系细胞 (CD11b+)
        monocyte 
        macrophage 
            M1-like: iNOS+
            M2-like: CD163+ or CD206+
        cDC: conventional Dendritic cells 
            cDC1
            cDC2
        pDC: plasmacytoid Dendritic cells 
        MDSC: Myeloid-derived supressor cells
            Monocytic(M) MDSCs
            Polymorphonuclear(PMN) MDSCs
        粒细胞
            中性粒细胞  
            嗜酸性粒细胞 
            嗜碱性粒细胞 
            肥大细胞
    淋系细胞
        B细胞 
        plasma cell: 浆细胞
        T细胞
        NK 细胞:
            CD56 low 
            CD56 high
        NKT 
            type I NKT: iNKT 
            type II NKT:
        

髓系来源抑制细胞：一种具有免疫抑制功能的髓系细胞，可以抑制T细胞的活性，从而影响免疫应答。




# T Cells (CD3D, CD3E, CD8A),
# B cells (CD19, CD79A, MS4A1 [CD20]),
# Plasma cells (IGHG1, MZB1, SDC1, CD79A),
# Monocytes and macrophages (CD68, CD163, CD14),
# NK Cells (FGFBP2, FCG3RA, CX3CR1),
# Photoreceptor cells (RCVRN),
# Fibroblasts (FGF7, MME),
# Endothelial cells (PECAM1, VWF).
# epi or tumor (EPCAM, KRT19, PROM1, ALDH1A1, CD24).


immune (CD45+, PTPRC),
epithelial/cancer (EpCAM+, EPCAM),
stromal (CD10+, MME, fibo or CD31+, PECAM1, endo)




========================================
淋系发育路径：B, T, ILC(NK, )
----------------------------------------
先天性淋巴细胞（Innate lymphoid cell, ILC），包括 NK



========================================
|-- B cell marker & plasma cell 浆细胞
----------------------------------------
https://www.rndsystems.com/cn/research-area/b-cell-markers

1. 正常B细胞的发育和分化途径
https://mp.weixin.qq.com/s?__biz=MjM5MTU2Njg4MA==&mid=2651823592&idx=1&sn=12a92d156920cb604642572111e90d55
B1和 B2是两个独立分化的B细胞谱系，B2细胞是主流，在识别抗原并接受适当的 T 细胞辅助时，可以分化为短寿命PC、记忆B细胞或长寿命PC，B1细胞虽然相对少，但亦是体液免疫不可缺少的一部分。

摘自：Eva Schrezenmeier, David Jayne, Thomas Dörner. Targeting B Cells and Plasma Cells in Glomerular Diseases: Translational Perspectives. JASN Mar 2018, 29 (3) 741-758; DOI: 10.1681/ASN.2017040367




2. mouse atlas2 
> b1=FindMarkers(atlas2, ident.1 = "B cell")

["Fcmr","Ralgps2","Fcrla","Pkig","Xist","Tifa","Bank1","Bach2","Cd72","Pax5","Rhoh","Gm30211","Igkc","Foxp1","Cd79a","Pou2f2","Pafah1b3","Siglecg","Spib","Cd37","Cd19","Chchd10","Vpreb3","Pou2af1","Ebf1","Cnp","Dnajc7","Cd79b","Sox4","Mef2c","Ighd","Ighm","Ptp4a3","Ly6d","Apobec3","Tnfrsf13c","Iglc1","Iglc3","Iglc2","H2-DMb2","H2-Ob","H2-Ab1","H2-Aa","H2-Eb1","Mzb1","Cd74","Ptprcap","Ms4a1","Blnk","Igha"] 






========================================
|-- T cell: CD4+T, CD8+T
----------------------------------------
1. mouse atlas2
> b1=FindMarkers(atlas2, ident.1 = "T cell")

["Cd28","Bcl2","Rpl12","Rpl35","Rpl36a","Rps27","Cd2","Rps6","Lck","Trbc1","Trbc2","Gimap4","Gimap6","Gimap3","Cd8b1","Tmsb10","Rps5","Rps19","Nkg7","Rpl13a","Rps15a","Lat","Rplp2","Rps15","Uba52","Trac","Thy1","Cd3g","Cd3d","Cd3e","Rplp1","Rpl4","Shisa5","Rpl14","Rpl23a","Ccl5","Skap1","Rpl27","Rps23","Rps7","Il7r","Rpl3","Rps28","Rps18","H2-Q7","Rpl36","Rps14","AW112010","Ms4a4b","Ms4a6b"] 





========================================
|-- 先天性淋巴细胞（Innate lymphoid cell, ILC）: NK, ILC2, ILC3
----------------------------------------
1. mouse atlas2
> b1=FindMarkers(atlas2, ident.1 = "NK cell")

["Bcl2","Rgs1","Xcl1","Dusp2","Sh2d2a","S100a10","Cd2","Ugcg","Lck","Txk","Vps37b","Gimap4","Gimap5","Klrb1a","Klrb1c","Klre1","Klrd1","Klrk1","Klrc2","Klri2","Klra4","Klra8","Klra9","Klra7","Klra3","Ncr1","Nkg7","Ifngr1","Prf1","Ifng","Gzmb","Eomes","Ccl5","Ccl3","Ccl4","Cd7","Serpinb6b","Serpinb9","Ctla2a","Gzma","Id2","Il2rb","Lgals1","Sytl3","H2-K1","H2-Q7","Ctsw","Ahnak","AW112010","Ms4a4b"] 













========================================
髓系发育路径：mono, macrophage, DC
----------------------------------------
Cell：张泽民研究组揭示结直肠癌靶向髓系细胞的免疫治疗机理 2020
https://baijiahao.baidu.com/s?id=1664423924575081741&wfr=spider&for=pc





========================================
|-- monocyte 单核细胞 //todo
----------------------------------------
1. mouse atlas2
b1=FindMarkers(atlas2, ident.1 = "Monocyte")
# b1= FindAllMarkers(atlas2, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)

["Fn1","Dbi","Vim","Zeb2","Cst3","Mafb","Ctsz","Psma7","Anxa5","S100a4","Ctss","Klf4","Prdx1","Sdc3","Plac8","Rassf4","Clec4a1","Clec4a3","Apoe","Ctsc","Ifitm3","Smpdl3a","Psap","Lyz2","Lrp1","Lamp1","Hpgd","Lpl","Hmox1","Lgals3","Ctsb","Trf","Ccr2","Cd68","Ccl9","Gngt2","Grn","F13a1","Npc2","Lgmn","Pld4","Crip1","Selenop","Lgals1","Aif1","Csf1r","Ahnak","Ms4a4c","Ms4a6c","Mpeg1"] 










========================================
|-- macrophage marker 巨噬细胞: M1 促炎-抗肿瘤, M2 抑炎-促肿瘤
----------------------------------------
1. 2021, Mol Ther Nucleic Acids, IF=7.032
(单基因免疫相关分析发7分+2区SCI)
ncRNAs-mediated high expression of SEMA3F correlates with poor prognosis and tumor immune infiltration of hepatocellular carcinoma
研究SEMA3F在多种癌症中的表达水平和与预后的作用。并研究SEMA3F与免疫细胞浸润和免疫检查点表达的相关性。

B细胞标志物（CD19和CD79A）、
CD8+ T细胞标志物（CD8A和CD8B）、
CD4+ T细胞标志物（CD4）、
M1巨噬细胞标志物（NOS2、IRF5和PTGS2）、
M2巨噬细胞标志物（CD163、VSIG4和MS4A4A）、
中性粒细胞标志物（CEACAM8, ITGAM和CCR7）
和树突状细胞标志物（HLA-DPB1, HLA-DQB1, HLA-DRA, HLA-DPA1, CD1C, NRP1 和 ITGAX )








========================================
|-- DC marker 树突细胞
----------------------------------------
1. in mouse

(1)
1) wangXuefei-2021.11
"Ccl22","Ccr7","Fscn1","Ccl5","Tnfrsf9","Sema7a","Stat4","Il12b",#cDC1
"Xcr1","Cd207","Clec9a","Batf3","Cadm1","Cd36","Itgae","Cd24a",
"Itgax","Ly6i","H2-DMb1","Cd209a","Lilrb4a","H2-DMb2","Csf1r",#cDC2
"Siglech","Ccr9","Tcf4","Ctsl","Bst2","Bcl11a","Runx2",#pDC

DotPlot(scObj, features =
list(
	cDC1=c("Ccl22","Ccr7","Fscn1","Ccl5","Tnfrsf9","Sema7a","Stat4","Il12b"),
	cDC2=c("Xcr1","Cd207","Clec9a","Batf3","Cadm1","Cd36","Itgae","Cd24a",
		   "Itgax","Ly6i","H2-DMb1","Cd209a","Lilrb4a","H2-DMb2","Csf1r"),
	pDc=c("Siglech","Ccr9","Tcf4","Ctsl","Bst2","Bcl11a","Runx2")
  )
)+RotatedAxis()


2). mouse BM atlas2
> b1 = FindMarkers(atlas2, ident.1 = "Dendritic cell") # 貌似不太靠谱
["Rpl31","Ramp1","Ppfia4","Atp1b1","Tagln2","Kmo","Bmyc","Snx5","Rpl10","Plac8","Gltp","Ptms","Lair1","Klk1","Siglech","Nucb2","Cox6a2","Ccnd1","Psap","Upb1","Cd209d","Bst2","Mvb12a","Pgls","Irf8","Rnase6","Ctsb","Tsc22d1","Ctsh","Ccr9","Bcl11a","Rnf187","Dnajc7","Grn","Cd300c","Smim5","Syngr2","Cd7","Ly86","H2afy","Ctsl","Gm21762","Pld4","Dap","Ly6d","Lgals1","AC140186.1","Runx2","Tcf4","Dntt"] 



(2) 展示 marker 的4种方式: tsne/umap图(FeaturePlot)、热图(DoHeatmap)、堆叠小提琴图(VlnPlot)、气泡图(DotPlot)
https://www.cnblogs.com/TOP-Bio/p/14253607.html



(3) https://github.com/effiken/Maier_et_al_nature_2020/blob/master/plot_figures/plot_1c.R
pathways$'Maturation' <- rev(c("Cd40","Cd80","Cd86","Relb","Cd83"))
pathways$'Regulatory' <- rev(c("Cd274","Pdcd1lg2","Cd200","Fas","Aldh1a2","Socs1","Socs2"))
pathways$'TLRs & adaptors' <- strsplit("Tlr1,Tlr2,Tlr3,Tlr4,Tlr5,Tlr6,Tlr7,Tlr8,Tlr9,Tlr11,Ticam1,Myd88",",")[[1]]
pathways$'Migration' <- rev(c("Ccr7","Myo1g","Cxcl16","Adam8","Icam1","Fscn1","Marcks","Marcksl1"))











========================================
粒细胞(Granulocytes)发育路径：中性粒细胞，嗜酸性粒细胞，嗜碱性粒细胞，肥大细胞
----------------------------------------




========================================
|-- Neutrophil marker 中性粒细胞
----------------------------------------

//Yue wenjun
c("S100a9", "S100a8", "Retnlg", "Ngp", "Lcn2", "Lyz2", "Mmp8", "Ltf", "Wfdc21", "Ifitm6", "Camp", "Mmp9", "Pglyrp1", "Chil3", "Cd177", "Fpr2", "Cxcr2", "Slpi", "Anxa1", "Lrg1", "Alox5ap", "Gda", "Mcemp1", "Cybb", "Slfn4", "Ckap4", "Il1f9", "S100a6", "Clec4e", "Cd24a", "Actn1", "Cd33", "S100a11", "Msrb1", "C5ar1", "Ly6c2")



1. in atlas2 

> wjl4=FindMarkers(atlas2, ident.1 = "Neutrophil")
> wjl4.markers = wjl4 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
    top_n(n = 50, wt = avg_log2FC)
> DotPlot(atlas2, features = rownames(wjl4.markers) )+RotatedAxis()

> rownames(wjl4.markers) |> jsonlite::toJSON()
["Rnf149","Il1r2","Cxcr2","G0s2","Lcn2","Hdc","Il1b","Slpi","Mmp9","Slc7a11","S100a6","S100a8","S100a9","S100a11","Chil3","Csf3r","Fbxl5","Cxcl2","Asprv1","Mxd1","Clec4d","C5ar1","Pglyrp1","Ifitm2","Ifitm1","Ifitm6","Srgn","Mcemp1","Gsr","Hp","Mmp8","Camp","Ngp","Ltf","Ccr1","Slfn1","Ccl6","Wfdc17","Wfdc21","Pygl","Ly6g","Grina","Stfa2l1","Gm5483","Retnlg","Msrb1","H2-Q10","Lrg1","Anxa1","Gda"]









========================================
|-- basophil [ˈbeɪsəfɪl] n. 嗜碱性粒细胞
----------------------------------------
https://www.rndsystems.com/cn/resources/cell-markers/immune-cells/granulocytes/basophil-cell-markers

1. for mouse in Bone marrow

> wjl3=FindMarkers(atlas2, ident.1 = "Basophil")
> wjl3.markers = wjl3 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
    top_n(n = 50, wt = avg_log2FC)
> DotPlot(atlas2, features = rownames(wjl3.markers) )+RotatedAxis()

> rownames(wjl3.markers) |> jsonlite::toJSON()
["Il18r1","Rgs1","Mpc2","Fcer1a","Hdc","Cpa3","S100a10","Csf1","Gm12840","Padi2","Hgf","Il6","Tec","Plac8","Lat2","Gata2","Ptms","Cebpa","Csrp3","Ifitm1","Lilr4b","Cd63","Cdh1","Slc7a8","Mcpt8","Tbc1d4","Gpr183","Cyp11a1","Nedd4","Osm","Ccl9","Ccl3","Ccl4","Itga2b","Csf2rb2","Csf2rb","Cd200r3","Runx1","Sytl3","Prss34","Rab44","Ier3","Emilin2","Ms4a2","Stx3","Jak2","Ctsg","Ccl6","Jun","Hsph1"]

// 怀疑这是否注释错了！这是 嗜碱性粒细胞 还是 肥大细胞？ //todo



> DotPlot(atlas2, features = c(
     wjl3 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
         top_n(n = 50, wt = avg_log2FC) %>% arrange(-pct.1) %>% rownames()
 ) )+RotatedAxis()
> 










========================================
|-- mast cell 肥大细胞，特点是 IgE FC 受体(Fcer1g) //todo
----------------------------------------
https://www.rndsystems.com/cn/resources/cell-markers/immune-cells/granulocytes/mast-cell-markers

1.
目前认为，肥大细胞驱动的过敏反应。主要是抗原诱导肥大细胞表面FceRI受体分子的聚集，引发肥大细胞释放炎症介质的结果。肥大细胞均含有特定的胞质颗粒，其中贮存有炎症介质。介质释放到胞外区称为脱颗粒(degranulation)。

Fcer1g
Fcer1a

mast=c("Fcer1a", "Itgb7", "Fcer1g", "Cpa3","Mcpt8", "Csf1"),


2.不同
(1) 位置不同 
嗜碱性粒细胞存在于血液中，是白细胞的一种，占血液白细胞总数的0-0.5％，而肥大细胞主要存在于外周组织中，可以存在于呼吸道、消化道、末梢神经等周围组织。

(2) 释放物质不同
肥大细胞活化过程中产生前列腺素PGE2和PGD2,使小血管扩张,通透性增高，对疼痛敏感,PGD2还引起支气管收缩,抑制血小板聚集，促进嗜碱性粒细胞释放组胺。阿斯匹林可影响前列腺素的代谢。
Ptger2
Ptgds

Cr1l









========================================
*** 红细胞（red blood cell, RBC; erythrocyte, ERY）CD45-； 造血干细胞 Hematopoietic stem cell(HSC) 分化路径 ***
----------------------------------------
Hematopoietic / ,hemətəʊpɒɪ'i:tɪk / adj.造血的；生血的
erythrocyte / ɪˈrɪθrəsaɪt / n. [细胞] 红细胞；[细胞] 红血球


红细胞和血小板中不含CD45。


HSC, MPP, 
pro-祖细胞：
    burst forming unit-erythroid: BFU-E
    colony forming unit-erythroid: CFU-E
pre-前体细胞：
    到前体细胞，可以有形态差异了：原始 红细胞，早幼红细胞，中幼红细胞，晚幼红细胞
网织红细胞：
    晚幼红细胞不再具备分裂能力，脱核后形成网织红细胞释放入血，进一步生成成熟红细胞。
    脱核在晚幼红细胞阶段发生,晚幼红细胞刚脱核的分化阶段成为网织红细胞,其胞质内仍含嗜碱物质,属未成熟红细胞。
    成熟红细胞由网织红细胞进一步发育而来

血小板 是 巨红核细胞碎片。


> table(atlas2$majorCellType)
   HSC            MPP     Neutrophil       Monocyte Dendritic cell       Basophil 
   203            376          53750          12594           4311            995 
T cell        NK cell         B cell  Megakaryocyte    Erythrocyte 
 11394           2817          17957            364           1316 


> b1=FindMarkers(atlas2, ident.1 = "HSC")
> b1.markers = b1 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
    top_n(n = 50, wt = avg_log2FC);

DotPlot(atlas2, features = rownames(b1.markers) )+RotatedAxis();
rownames(b1.markers) |> jsonlite::toJSON()



========================================
|-- HSC -> MPP
----------------------------------------
1. for mouse in Bone marrow
(1) HSC 
["Cd34","Egfl7","Procr","Car2","Adgrl4","Pdzk1ip1","Gm19590","Gng11","Tmem176b","Gata2","Rab38","Tspan4","Myct1","Adgrg1","Tsc22d1","Nrgn","Meis1","Hlf","Angpt1","Krt18","Muc13","Ctla2a","Tmem176a","Serpina3g","Mllt3","Lmo2","Sox4","Kit","Rgs1","Glul","Gstm1","Msi2","Pebp1","Nr4a1","Rpl3","Rpl10a","Rps4x","Ramp1","Rps14","Rpl36a","Eef1a1","Dusp2","Rpl21","Rpl32","Rpl14","Rps18","Rps6","Rpl22l1","Ccl4","Jun"] 

(2) MPP
["Rgs1","Cd34","Lmo2","Car2","Adgrl4","Cdk6","Tmem176b","Rab38","Myct1","Adgrg1","Tsc22d1","Igfbp4","Sox4","Ctla2a","Serpina3g","Prtn3","Myb","Stmn1","Pebp1","Ccl4","Ramp1","H2afy","Hnrnpa1","Cmtm7","Rpl3","Npm1","Rpl10a","Rpl15","Rpl32","Rps2","Ccl9","Eef1g","Nr4a1","Rps4x","Rps17","Rpl36a","Eef1a1","Rpl14","Rps18","Rpl22l1","Rps5","Ncl","Rplp0","Rps19","Rps6","Rpl36","Rpl35","Ccl3","Jun","Hspd1"] 


(3) 互相比较
HSC vs. MPP
["Pdzk1ip1","Sult1a1","Procr","Hlf","Mllt3","Txnip","Hacd4","Mpl","Ifitm3","Tgm2","mt-Co1","Nkx2-3","Npdc1","Trim47","Car2","Mecom","Gda","Ltb","Mmrn1","Nupr1","Glul","Cavin2","Ly6a","Adgrg1","Clec1a","Aldh1a1","Itsn1","Zbtb20","Meis1","Gng11","Tsc22d1","Iigp1","Tbxas1","Alcam","Shisa5","Ldhb","H2-Q6","Eif4a2","Zfp36l2","Zfp467","Aplp2","Uba7","Nceh1","Cited2","Egr1","S100a6","Gcnt2","Mycn","mt-Nd4","Pbx1"]

MPP vs. HSC 
["Plac8","Ptma","H2afy","Eif4a1","Ran","Mpo","Nkg7","Cd48","H2afz","Stmn1","Slc25a5","Cdk6","Dynll1","Igfbp4","Ctsg","Ybx1","Cks2","Mcm6","BC035044","S100a10","Hspa8","Adgrg3","Tmsb10","Hdgf","Dtymk","Anp32b","Cebpa","Ccl9","Nme1","Ranbp1","Nhp2","Srm","Mif","Apex1","Phgdh","Cpa3","Lat2","Ncl","Dut","Ap3s1","Lgals1","Ppp1r14b","Sell","Hnrnpab","Cdca7","Hsp90aa1","Hspe1","Hspd1","Dnaja1","Hist1h2ap"]









========================================
|-- Megakaryocyte 巨核细胞: 成熟的巨核细胞边缘部分破裂脱落后形成血小板
----------------------------------------
1. mouse atlas2
(1) b1=FindMarkers(atlas2, ident.1 = "Megakaryocyte")
["Cavin2","Hmgb3","Car2","Dapp1","Cdk6","Pf4","H1fx","Ybx3","Adgrg1","Zfpm1","Nrgn","Nedd4","Meis1","Itga2b","Ctla2a","Angpt1","Muc13","Slc14a1","Dut","Stmn1","Lmo2","Top2a","Hist1h2ae","Kcnq1ot1","Hist1h1b","Mki67","Nucks1","Mef2c","Hdgf","Pebp1","Snrpd1","Atpif1","Rgs18","Etfb","Ran","Anp32b","Nap1l1","Npm1","Mif","Ncl","Serbp1","Pbx1","Set","Ppbp","Hspd1","Tuba1b","Hist1h2ap","Pdcd4","Tubb5","Hspe1"] 

(2) b1=FindMarkers(atlas2, ident.1 = "Megakaryocyte", ident.2="Erythrocyte")
["Mef2c","Serpina3g","Meis1","Ctla2a","Pbx1","Plek","Cavin2","Itga2b","Fli1","Cd9","Angpt1","Zyx","Nrgn","Tmsb4x","Sptbn1","Rgs18","Celf2","Cited2","Ptpn18","Bin2","Rab27b","Ifitm3","H1fx","Sh3bgrl3","Pkm","Adgrg1","Tagln2","H2afy","Pf4","Dapp1","Fxyd5","Gmfg","Actg1","Arpc1b","Rap1b","H2-K1","Arhgdib","Cmtm7","Rabgap1l","Vwf","Lyz2","Pdcd4","Ppbp","S100a8","S100a9","Ngp","Lcn2","Ltf","Wfdc21","Camp"] 





========================================
|-- Erythrocyte 红细胞 / 红血球
----------------------------------------
1. mouse atlas2
(1) b1=FindMarkers(atlas2, ident.1 = "Erythrocyte")
["Hspd1","Ncl","Ctse","Mgst3","Dut","Hmgb3","Car1","Car2","Hdgf","Hemgn","Anp32b","Alad","Ermap","Pabpc4","Atpif1","Rhd","C1qtnf12","Ran","Cldn13","Mcm7","Aqp1","Serbp1","Ybx3","Blvrb","Stard10","Rrm1","Hbb-bt","Hbb-bs","Mki67","Rps12","Metap2","Gypa","Klf1","Prdx2","Hmbs","Mns1","Hba-a1","Hba-a2","Npm1","Nme1","Atp5g1","Top2a","Slc4a1","Hist1h1b","Tmem14c","Dek","Glrx5","Tfrc","Cpox","Rps2"] 

(2) b1=FindMarkers(atlas2, ident.1 = "Erythrocyte", ident.2="Megakaryocyte")
["Blvrb","Prdx2","Tspo2","Ermap","Klf1","Car1","Rhd","Car2","Ctse","Glrx5","Cldn13","Gypa","Rhag","Tspan33","Slc38a5","Metap2","Ank1","Cpox","Cd24a","Hmbs","Nxpe2","Tfrc","Abcb4","Aqp1","Ces2g","C1qtnf12","Spta1","Alad","Hebp1","Fth1","Smim1","Minpp1","Isg20","Mns1","Fech","Ubac1","Hba-a1","Tmem14c","Mkrn1","Hbb-bt","Mgst3","Hba-a2","Hbb-bs","Hemgn","Snca","Rrm2","Slc25a37","Slc4a1","Mt1","Alas2"] 









========================================
Endothelial cell markers 内皮细胞 //todo
----------------------------------------

1. paper:
(1).Cell. 2020 Feb 20;180(4):764-779.e20. doi: 10.1016/j.cell.2020.01.015. Epub 2020 Feb 13.
Single-Cell Transcriptome Atlas of Murine Endothelial Cells
https://pubmed.ncbi.nlm.nih.gov/32059779/

(2).Circulation. 2021 Jul 27; 144(4): 286–302.
Published online 2021 May 25. doi: 10.1161/CIRCULATIONAHA.120.052318
PMCID: PMC8300155 | PMID: 34030460
Integrated Single-Cell Atlas of Endothelial Cells of the Human Lung
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8300155/


CD31(Pecam1), eNOS(Nos3), VE-cadherin(Cdh5), vWF(Vwf), and CD146(Mcam)
	"Pecam1", "Nos3", "Cdh5", "Vwf", "Mcam", #Endothelial



ref:
https://www.abcam.com/primary-antibodies/endothelial-cell-markers








========================================
Fibroblast marker 成纤维细胞 //todo
----------------------------------------
"Col1a2", "Col3a1", "Fbln2", "Fstl1", "Gsn", "Mmp2", "Sparc", "Vim",


























========================================
细胞类型 自动注释: singleR
----------------------------------------

Using SingleR to annotate single-cell RNA-seq data
https://www.bioconductor.org/packages/release/bioc/vignettes/SingleR/inst/doc/SingleR.html





1. 安装

> BiocManager::install("SingleR")
Bioconductor version 3.13 (BiocManager 1.30.16), R 4.1.0 (2021-05-18)
Installing package(s) 'SingleR'
also installing the dependencies ‘sparseMatrixStats’, ‘RcppHNSW’, ‘ScaledMatrix’, ‘rsvd’, ‘DelayedMatrixStats’, ‘BiocNeighbors’, ‘BiocSingular’, ‘beachmat’


> library(SingleR)
Loading required package: SummarizedExperiment
Loading required package: MatrixGenerics
Loading required package: matrixStats
...

(2) 解决报错

1) mouseImmu <- ImmGenData()
Error in loadNamespace(x) : there is no package called ‘celldex’
In addition: Warning message:
'ImmGenData' is deprecated.
Use 'celldex::ImmGenData' instead.
See help("Deprecated")

安装该包: BiocManager::install("celldex") #version 1.2.0  Reference Index for Cell Types

# 探索一下该包
> table(mouseImmu$label.main) # 各种细胞类型
> table(mouseImmu$label.fine) # 精细细胞类型

> mouseImmu
class: SummarizedExperiment
dim: 22134 830
metadata(0):
assays(1): logcounts
rownames(22134): Zglp1 Vmn2r65 ... Tiparp Kdm1a
rowData names(0):
colnames(830): GSM1136119_EA07068_260297_MOGENE-1_0-ST-V1_MF.11C-11B+.LU_1.CEL
  GSM1136120_EA07068_260298_MOGENE-1_0-ST-V1_MF.11C-11B+.LU_2.CEL ...
  GSM920654_EA07068_201214_MOGENE-1_0-ST-V1_TGD.VG4+24ALO.E17.TH_1.CEL
  GSM920655_EA07068_201215_MOGENE-1_0-ST-V1_TGD.VG4+24ALO.E17.TH_2.CEL
colData names(3): label.main label.fine label.ont



> mouseRNA <- MouseRNAseqData() #等待下载，然后载入
> mouseRNA
class: SummarizedExperiment
dim: 21214 358
metadata(0):
assays(1): logcounts
rownames(21214): Xkr4 Rp1 ... LOC100039574 LOC100039753
rowData names(0):
colnames(358): ERR525589Aligned ERR525592Aligned ... SRR1044043Aligned SRR1044044Aligned
colData names(3): label.main label.fine label.ont









2. 使用

library(SingleR)

#这是测试，为了快，先取个子集
table(scObj_known2$seurat_clusters)
sce=subset(scObj_known2, downsample=200)
sce #6.4k cells

# 获取数据
sce_for_SingleR <- GetAssayData(sce, slot="data")
clusters=sce@meta.data$seurat_clusters

# 获取免疫参考数据
mouseImmu <- ImmGenData() #需要 celldex 包
#/home/wangjl2/.cache/R/ExperimentHub
# does not exist, create directory? (yes/no): yes
pred.mouseImmu <- SingleR(test = sce_for_SingleR, ref = mouseImmu, labels = mouseImmu$label.main,
                          #method = "cluster",
                          clusters = clusters,
                          assay.type.test = "logcounts", assay.type.ref = "logcounts")

# 获取小鼠参考数据
mouseRNA <- MouseRNAseqData() #等待下载，然后载入
pred.mouseRNA <- SingleR(test = sce_for_SingleR, ref = mouseRNA, labels = mouseRNA$label.fine ,
                         #method = "cluster",
                         clusters = clusters,
                         assay.type.test = "logcounts", assay.type.ref = "logcounts")


# 两者综合
cellType=data.frame(ClusterID=levels(sce@meta.data$seurat_clusters),
                    mouseImmu=pred.mouseImmu$labels,
                    mouseRNA=pred.mouseRNA$labels )
head(cellType)
dim(cellType)
# 添加上注释
sce@meta.data$singleR=cellType[match(clusters,cellType$ClusterID),'mouseRNA']



pro='first_anno'
DimPlot(sce,reduction = "umap",label=T, group.by = 'singleR')+scale_color_manual(values=allcolour)
# ggplot2::ggsave(filename = paste0(pro,'_tSNE_singleR.pdf'))
DimPlot(sce,reduction = "umap",label=F,split.by ='orig.ident',group.by = 'singleR', ncol=4)&scale_color_manual(values=allcolour)
# ggplot2::ggsave(filename = paste0(pro,'_tSNE_singleR_by_orig.ident.pdf'))

#save(sce,file = 'last_sce.Rdata')
# saveRDS(sce,file = 'sce_v0.1_.Rdata')



















========================================
My data
----------------------------------------

1. neutrophil cells from FACS: Cd11b+Ly6d

(1)趋化因子 Chemokine
趋化因子被分为四个主要亚家族：CXC、CC、CX3C和XC

1)Cxcr1,2,3,4,5,6
	Cxcr3,6: T cell;
	Cxcr5: B

C-X-C/α亚族，主要趋化中性粒细胞



2) 趋化因子CXC配体9
Cxcl1,2,3, 5,  9,10, 12,13,14,15,16
	Cxcl3: Nue?(11)
	Cxcl2: Nue?(11,25)
	Cxcl9: Nue?(25)
	Cxcl10: Nue?(25, 11)
	Cxcl13: Macrophage
	Cxcl16: Macrophage, Nue?(25)

3) Ccl 系列
	macrophage: Ccl2,7,8, 12,
	Ccl24: macrophage
	Ccl5: NK
	mast cell: Ccl3,4,6,9,


4) 趋化因子受体 Ccr1,2,3,4,5,6,7,8,9,10
趋化因子受体(Cxc Chemokine Receptor 7)
	Ccr6: B
	Ccr7: B
	Ccr10: plasma
	Ccr2: Mono?(22),

	Ccrl2: Nue?(11,25),
	Ccr1: Nue?(27),

5) Cx3
	Cxc3cr1: plasma;
6) Xc
	Xcl1: NK, T;
	Xcr1: cDC;



(2) cytokines 细胞因子
由免疫细胞（如单核、巨噬细胞、T细胞、B细胞、NK细胞等）和某些非免疫细胞（内皮细胞、表皮细胞、纤维母细胞等）经刺激而合成、分泌的一类具有广泛生物学活性的小分子蛋白质。

细胞因子可被分为白细胞介素、干扰素、肿瘤坏死因子超家族、集落刺激因子、趋化因子、生长因子等。



1) 白介素 Il*
	Il7r: T, mast cell;
	Il6: mast cell;
	Il2ra: T;

2) 集落刺激因子（colony stimulating factor, CSF)
	Csf1: mast cell;

3) 干扰素（interferon, IFN)
	Ifng: T, NK,
	Ifngr1: T, NK,cDC, Mono?(22),


4) 肿瘤坏死因子（tumor necrosis factor, TNF)
	T: Tnfrsf18, 9,4;
	Tnfrsf17: plasma;
	Tnf: Nue?(11,25)

5) 转化生长因子-β家族（transforming growth factor-β family, TGF-β family)
	Tgfbr2: macrophage;

6) 生长因子（growth factor,GF）


7) 趋化因子家族（chemokine family)




(2) 颗粒酶 Gzm*
	NK: Gzma,b




(3) Siglec*
	Siglecg: B, cDC
	Siglech: pDC,
	Siglece:



(4) Ly6*
	Ly6d: pDC, plasma;
	Ly6i: cDC?/mono?


(5) Clec*
	Clec9a: cDC
	Clec1b: Platelet(Ppbp)
	Clec4d: nue?(11,27)

(6) Ccn*
	Ccne2: 29,
	Ccnb2: 29,






========================================
color sets
----------------------------------------
1. 张泽民 Science 2021,
# CD8+ meta cluster:
colors.CD8=c("#96C3D8", "#5F9BBE", "#F5B375", "#C0937E", "#67A59B", "#A5D38F", "#4A9D47", "#F19294", "#E45D61", "#3377A9", "#BDA7CB", "#684797", "#8D75AF", "#CD9C9B", "#D62E2D", "#DA8F6F", "#F47D2F")
barplot(rep(1,length(colors.CD8)), col=colors.CD8, border = NA, space=0, axes=F)


# CD4+ meta cluster:
colors.CD4=c("#79AECB","#4C8DA1","#84BC95","#70B866","#AB9697","#EC8D63","#CFC397","#F5A666","#4588B4","#CEA168","#90966A","#89C47C","#6A9A52","#E9787A","#DD4448","#A38CBD","#795FA3","#E0C880","#BA7D4F","#A65A35","#DE4B3F","#DA8F6F","#E66D52","#F6954A")
barplot(rep(1,length(colors.CD4)), col=colors.CD4, border = NA, space=0, axes=F)




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------

