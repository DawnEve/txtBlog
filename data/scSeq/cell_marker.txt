Cell Marker list


第一次分群: 
    immune (CD45+, PTPRC),
    epithelial/cancer (EpCAM+, EPCAM),
    stromal (CD10+, MME, fibo or CD31+, PECAM1, endo)
		CD10:MME     fibo
		CD31:PECAM1  endo

接着 非负矩阵


BMMC(bone marrow mononuclear cell) 骨髓单个核细胞：是包括单核细胞，淋巴细胞，造血干细胞和祖细胞在内的具有单个核的细胞混合群体（无红细胞和粒细胞）

PBMC(peripheral blood mononuclear cell) 外周血单个核细胞:注意这里是 mononuclear cell单个核细胞，而不是Monocyte单核细胞,是指任何拥有圆形的细胞核的外周血细胞，这些细胞包括淋巴细胞（T细胞、B细胞、NK细胞）和单核细胞，而红血球和血小板由于没有细胞核不属于此类，粒细胞（包括中性粒细胞, 嗜碱性粒细胞和嗜酸性粒细胞）拥有多分叶的核，也不属于此类




========================================
查基因和细胞的数据库: 我自己的merker列表
----------------------------------------

1. 查基因的意义，基因的曾用名
https://www.genecards.org/cgi-bin/carddisp.pl?gene=IL2RA&keywords=IL2RA
Receptor for interleukin-2. The receptor is involved in the regulation of immune tolerance by controlling regulatory T cells (TREGs) activity. TREGs suppress the activation and expansion of autoreactive T-cells.


(2) 查人的的基因
https://www.genenames.org/




2. 查基因的表达位置，有抗体染色切片证据
https://www.proteinatlas.org/ENSG00000203747-FCGR3A/cell
https://www.proteinatlas.org/ENSG00000109083-IFT20/cell 细胞骨架
https://www.proteinatlas.org/ENSG00000177606-JUN/cell 核内





3. 细胞类型标记物 数据库

CellMarker：http://biocc.hrbmu.edu.cn/CellMarker/index.jsp
PanglaoDB：https://panglaodb.se/index.html


商业抗体公司整理的信息
https://www.cellsignal.com/pathways/immune-cell-markers-mouse
https://www.cellsignal.cn/pathways/immune-cell-markers-mouse

https://assets.thermofisher.com/TFS-Assets/BID/Product-Information/Immuno-cell-guide-zh.pdf

https://www.abcam.cn/primary-antibodies/human-cd-antigen-guide-2



3. 可视化
(1) 展示 marker 的4种方式: tsne/umap图(FeaturePlot)、热图(DoHeatmap)、堆叠小提琴图(VlnPlot)、气泡图(DotPlot)
https://www.cnblogs.com/TOP-Bio/p/14253607.html


(2) https://github.com/effiken/Maier_et_al_nature_2020/blob/master/plot_figures/plot_1c.R
pathways$'Maturation' <- rev(c("Cd40","Cd80","Cd86","Relb","Cd83"))
pathways$'Regulatory' <- rev(c("Cd274","Pdcd1lg2","Cd200","Fas","Aldh1a2","Socs1","Socs2"))
pathways$'TLRs & adaptors' <- strsplit("Tlr1,Tlr2,Tlr3,Tlr4,Tlr5,Tlr6,Tlr7,Tlr8,Tlr9,Tlr11,Ticam1,Myd88",",")[[1]]
pathways$'Migration' <- rev(c("Ccr7","Myo1g","Cxcl16","Adam8","Icam1","Fscn1","Marcks","Marcksl1"))



4. 细胞注释的方法
(1) 背诵marker基因列表
(2) 整理自己看的markerlist，和top N marker 的 Jarcard 距离判断分类
(3) 注释网站和工具做参考
	* SingleR
	* Azimuth







5. 我的marker列表
详见: BioToolKit::marker_list/index.html

my.immmue.gene.list=list(
	"mast"=c('TPSAB1', 'CPA3', 'KIT', 'MS4A2'),

)

todo: 
	macrophage、Monocyte以及Dendritic细胞 怎么区分？  https://zhuanlan.zhihu.com/p/608898711






========================================
|-- 单细胞细胞类群基因marker鉴定新方法：COSG
----------------------------------------
2022年3月在线发表于 Brief Bioinformatics 上，题为：Accurate and fast cell marker gene identification with COSG，该工具同时有Python和R版本，这意味着无论你是 Seurat 用户还是 Scanpy 用户都可以使用这个工具。

传统的基因marker鉴定方法基于欧式距离。
基于 余弦值 的基因marker鉴定新方法：COSG（COSine similarity-based marker Gene identification）。



# install.packages('remotes')
remotes::install_github(repo = 'genecell/COSGR')

library(COSG)
library(dplyr)
COSG_markers <- cosg(
  pbmc3k,
  groups='all',
  assay='RNA',
  slot='data',
  mu=1,
  n_genes_user=900)

DotPlot(pbmc3k, assay = 'RNA',
              features = COSG_markers$names$B[1:10]) +
  ggtitle(label = 'B cell Markers with COSG') + 
  theme(axis.text.x = element_text(hjust = 1, angle = 45))




========================================
|-- 单细胞细胞类型注释工具 SingleR v2.4.1
----------------------------------------
SingleR利用了相关性的方法对单细胞数据的细胞类型进行了划分，显示了良好的效果
"我感觉SingleR是最好的自动注释包."


1. 安装
#devtools::install_github('dviraran/SingleR') #1.0.1 太古老了
# devtools::install_github('SingleR-inc/SingleR') #当前版本

BiocManager::install("SingleR")
packageVersion("SingleR")  #2.4.1

BiocManager::install("celldex")

(2) 教程
https://github.com/dviraran/SingleR
https://www.bioconductor.org/packages/release/bioc/vignettes/SingleR/inst/doc/SingleR.html
https://www.bioconductor.org/packages/release/bioc/html/SingleR.html

电子书: 
	Assigning cell types with SingleR  https://bioconductor.org/books/release/SingleRBook/
	https://github.com/LTLA/SingleRBook-base/blob/master/index.Rmd




2. 使用
以计算参考集A类细胞的Marker基因为例，先计算得到参考集中各个基因在A类细胞和其他细胞中表达量的中位数（因为参考集，每种细胞都有大量重复，所以可以计算中位数），然后根据中位数将参考集中细胞类型进行两两比较，计算表达差异倍数。

(1) 自带参考库
SingleR自带5个人的参考数据库和2个小鼠的参考数据库，每个数据库导入的方法如下：
library(SingleR)
library(Seurat)
library(celldex)
# human
hpca.se <- HumanPrimaryCellAtlasData()
bpe.se <- BlueprintEncodeData()
DICE <- DatabaseImmuneCellExpressionData() 
NHD <- NovershternHematopoieticData() 
MID <- MonacoImmuneData()
# mouse
MRD <- MouseRNAseqData() 
IGD <- ImmGenData()


(2) 确定Marker的数目
选取差异倍数最高的N个基因（upregulated）作为A类细胞的marke基因，那么A类细胞最终的Marker基因是两两比较差异基因的并集。这个指标N可以根据项目的情况优化调整。

Tips:
Marker基因的计算方法可以自己定义，比如定义为pairwise binomial tests
可以自己提供Marker基因list给到SingleR



3. 实战
library(SingleR)
library(Seurat)
library(celldex)

hpca.se <- HumanPrimaryCellAtlasData()
#/home/wangjl/.cache/R/ExperimentHub
#  does not exist, create directory? (yes/no): yes
hpca.se

sce1 <- scObj ## 赋值给其他变量，避免修改原变量。
sce_for_SingleR <- GetAssayData(sce1, slot="data")
sce_for_SingleR
clusters <- sce1@meta.data$seurat_clusters

(1) 按cluster预测: fast
pred.hesc <- SingleR(test = sce_for_SingleR, 
                     ref = hpca.se, 
                     labels = hpca.se$label.main,
                     #method = "cluster", 
                     clusters = clusters, 
                     assay.type.test = "logcounts", 
                     assay.type.ref = "logcounts")
#Warning message:
#'method="cluster"' is no longer necessary when 'cluster=' is specified

table(pred.hesc$labels)


# naming cluster
#new.cluster.ids <- c("Naive CD4 T", "CD14+ Mono", "Memory CD4 T", "B", "CD8 T", "FCGR3A+ Mono", "NK", "DC", "Platelet")
new.cluster.ids <- pred.hesc$labels
names(new.cluster.ids) <- levels(sce1)
sce1 <- RenameIdents(sce1, new.cluster.ids)
DimPlot(sce1, reduction = "umap", label = TRUE, pt.size = 0.5) + ggtitle("singleR prediction")



# 注释结果诊断
plotScoreHeatmap(pred.hesc)



(2) 按cell 预测: slow
pred.hesc2 <- SingleR(test = sce_for_SingleR,
                     ref = hpca.se, 
                     labels = hpca.se$label.main)
#10:30-> 11:00
table(pred.hesc2$labels)
table(pred.hesc2$labels, sce1$seurat_clusters)

sce1@meta.data$singleR <-pred.hesc2$labels
DimPlot(sce1, group.by = c("seurat_clusters", "singleR"), reduction = "umap")
DimPlot(sce1, group.by = c("singleR"), reduction = "umap", label=T)




(4) 多个数据库一起注释
https://blog.csdn.net/weixin_56845253/article/details/129315604

使用BP和HPCA两个数据库综合注释，使用list函数读入多个数据库

pbmc3 <- pbmc
pbmc3.hesc <- SingleR(test = pbmc_for_SingleR, ref = list(BP=bpe.se, HPCA=hpca.se), labels = list(bpe.se$label.main, hpca.se$label.main)) 
table(pbmc3.hesc$labels,meta$seurat_clusters)
pbmc3@meta.data$labels <-pbmc3.hesc$labels
print(DimPlot(pbmc3, group.by = c("seurat_clusters", "labels"),reduction = "umap"))


(5)注释结果诊断
1)基于scores within cells
print(plotScoreHeatmap(pbmc.hesc))

2)基于 per-cell “deltas”诊断
plotDeltaDistribution(pbmc.hesc, ncol = 3)
# Delta值低，说明注释结果不是很明确。

3)与cluster结果比较
tab <- table(label = pbmc.hesc$labels,
             cluster = meta$seurat_clusters)
pheatmap(log10(tab + 10))






4. 自定义注释数据集
myref <- sce2##这里为了检测，我们将参考数据集与目标数据集用同一个数据进行测试
myref$celltype <- Idents(myref)
table(Idents(myref))

# 读入参考数据集
Refassay <- log1p(AverageExpression(myref, verbose = FALSE)$RNA)#求细胞的平均表达
#Ref <- textshape::column_to_rownames(Ref, loc = 1)#另一种得到参考矩阵的办法
head(Refassay)#看看表达矩阵长啥样

# 构建一个SingleCellExperiment对象
ref_sce <- SingleCellExperiment::SingleCellExperiment(assays=list(counts=Refassay))

#参考数据集需要构建成一个SingleCellExperiment对象
# if(!require(scater))BiocManager::install('scater')
library(scater)
ref_sce <- scater::logNormCounts(ref_sce)

colData(ref_sce)$Type <- colnames(Refassay)


# 使用刚才自定义的参考数据集
testdata <- GetAssayData(sce, slot="data")
pred <- SingleR(test=testdata, 
                ref=ref_sce, 
                labels=ref_sce$Type,
                #clusters = scRNA@active.ident
                )
table(pred$labels)
cellType=data.frame(seurat= sce@meta.data$seurat_clusters,
                    predict=pred$labels)#得到seurat中编号与预测标签之间的关系



ref:
https://www.jianshu.com/p/c11ff102baa4
Sarah Williams (2019). celaref: Single-cell RNAseq cell cluster labelling by reference. R package version 1.0.1.





========================================
|-- 基于参考的细胞在线注释工具 Azimuth：‘reference-based mapping’ 
----------------------------------------
https://satijalab.org/azimuth/
https://azimuth.hubmapconsortium.org/

azimuth [ˈæzɪməθ] n. [测] 方位；[天] 方位角；偏振角

https://github.com/satijalab/azimuth
A Shiny web app for mapping datasets using Seurat v4


1. 保存Rds文件
sce2=CreateSeuratObject(counts = scObj@assays$RNA@counts, meta.data = scObj@meta.data )
saveRDS(sce2, file=paste0(outputRoot, keyword, "_2.input.Azimuth.Rds"))


2. 上传到网站
https://azimuth.hubmapconsortium.org/
我分别选了pbmc和bmmc两个参考数据集。
点击 Map cells to reference 按钮。




3. 目测效果并下载
在Download Results页面下载Predicted cell types and scores (TSV)，将下载得到的结果(azimuth_pred)重新上传到R中。


4. 查看
predictions <- read.delim('azimuth_pred.tsv', row.names = 1)
object <- AddMetaData(
	object = object,
	metadata = predictions)


我的代码：
#pbmc
predictions <- read.delim(paste0(outputRoot, '/refer/azimuth_pred-pbmc.tsv'), row.names = 1)
scObj_p <- AddMetaData(
  object = scObj,
  metadata = predictions)
DimPlot(scObj_p, group.by = "predicted.celltype.l2", label=T)
#
#bmmc
predictions <- read.delim(paste0(outputRoot, '/refer/azimuth_pred-bmmc.tsv'), row.names = 1)
scObj_b <- AddMetaData(
  object = scObj,
  metadata = predictions)
DimPlot(scObj_b, group.by = "predicted.celltype.l2", label=T)
#







========================================
|-- 注释细胞类型的具体过程：数据库法 CellMarker
----------------------------------------
http://biocc.hrbmu.edu.cn/CellMarker/


这个步骤其实看似简单，但工程量非常大。主要利用了一个叫cellMarker的数据库，就如你所说的选取每个cluster的前几位marker基因，一个个检索，另外也结合了相近的研究文献的结果对照着看。后来我实验室的同学写了个小程序帮我把那个的数据库里的数据都爬下来了，工作量减轻了不少。。

这个数据库其实还是很不成熟的，数据量很小也不太准确，所以只能找个大概，更可靠的来源还是文献















========================================
*** 文献细胞分类细节 ***
----------------------------------------

研究人员首先使用10x及Smart-seq2两种技术对从结直肠癌患者中收集的免疫和非免疫细胞进行单细胞转录组测序，从中鉴定出包括T细胞、B细胞、先天性淋巴细胞（Innate lymphoid cell, ILC）、髓系细胞、上皮细胞、成纤维细胞等主要细胞类群及下属的40个CD45+的免疫细胞类群和12个CD45-的非免疫细胞类群（图1）。


========================================
Seurat 5 使用的数据集 2023.11
----------------------------------------
https://www.nature.com/articles/s41587-023-01767-y#MOESM1

1. PBMC 33K from 10x
https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc33k

Input Files	Size	md5sum
FASTQs	89.29 GB	b469f5fcd7c88f45dc12ed52a2ae0aa3
Output Files    format details →	
Genome-aligned BAM	85.67 GB	13e81854412f4f3c2e873cb72a3c8177
Genome-aligned BAM index	16.17 MB	cd441d6ce67b134d1a5b252914a797f8
Per-molecule read information	5.55 GB	0cebc0ac09b1a863058b315cd0d7a4e2
Gene / cell matrix (filtered)	79.23 MB	fef79ae6064f704888df538aba3f1d5c
Gene / cell matrix (raw)	111.38 MB	7aef9897fe7fd5ccae24fa6b261c0f52
Clustering analysis	23.81 MB	3536d4e57a32ee9005e1ce72f6848dc4
Summary CSV	533 bytes	5323382c4e15a9f4b199dd8748403a71
Summary HTML	4.46 MB	c08c7b3544b7f619eb02ddec60391346

https://cg.10xgenomics.com/samples/cell-exp/1.1.0/pbmc33k/pbmc33k_fastqs.tar
https://cg.10xgenomics.com/samples/cell-exp/1.1.0/pbmc33k/pbmc33k_possorted_genome_bam.bam
https://cf.10xgenomics.com/samples/cell-exp/1.1.0/pbmc33k/pbmc33k_possorted_genome_bam_index.bam.bai
https://cf.10xgenomics.com/samples/cell-exp/1.1.0/pbmc33k/pbmc33k_filtered_gene_bc_matrices.tar.gz


(2) explore
@Zserver$ cd /home/wangjl/data/rsa/PBMC






2. BMMC multiome 多组学
We collected a total of ten 10x multiome datasets from the NeurIPS Multimodal Single-Cell Data Integration challenge website, representing 32,368 paired single-nucleus profiles of transcriptome and chromatin accessibility. We retained cells with total RNA counts between 1,000 and 10,000 and with total ATAC peak counts between 2,000 and 30,000. We applied SCTransform to normalize the gene expression data and TF-IDF to normalize ATAC peak counts. We used PCA (dimensions 1:40) and TF-IDF (dimensions 2:40) to reduce the dimensionality of each modality and construct the WNN graph.

Data acquisition source: https://openproblems.bio/competitions/neurips_2021/.

https://openproblems.bio/events/2021-09_neurips/
原始数据: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE194122
    https://www.ncbi.nlm.nih.gov/Traces/study/?acc=PRJNA799242&o=acc_s%3Aa 更多信息: 年龄，性别，血型，BMI，民族，是否抽烟。

测序样本: 
12个健康人的 BMMC 样本。
6个人 10x 多组学：表达 + ATAC
    * Multiome (GEX)
    * Multiome (ATAC)
6个人 10x 3‘ 单细胞表达 + 蛋白板测序
    * Cite (GEX & ADT)
Single-cell multiomics data collected from bone marrow mononuclear cells of 12 healthy human donors. 
Half the samples were measured using the 10X Multiome Gene Expression and Chromatin Accessability kit and 
half were measured using the 10X 3' Single-Cell Gene Expression kit with Feature Barcoding in combination with the BioLegend TotalSeq B Universal Human Panel v1.0. 

该数据用于竞赛。
每个样本取四个位置，标准流程。
然后注释细胞类型，去掉双细胞。
The dataset was generated to support Multimodal Single-Cell Data Integration Challenge at NeurIPS 2021. 
Samples were prepared using a standard protocol at four sites. 
The resulting data was then annotated to identify cell types and remove doublets. 

有些是多个地方，有些是单个地方。
The dataset was designed with a nested batch layout such that some donor samples were measured at multiple sites with some donors measured at a single site. 

竞赛：模式预测，模式匹配，多模式嵌入
In the competition, participants were tasked with challenges including modality prediction, matching profiles from different modalities, and learning a joint embedding from multiple modalities.

表达+atac 数据: GSE194122_openproblems_neurips2021_multiome_BMMC_processed.h5ad.gz	2.7 Gb	(ftp)(http)	H5AD






3. Human BMMC ATAC-seq 没下载

This human bone marrow dataset is an snATAC-seq dataset from Granja et al.43. As the reads were originally mapped to hg19, we used cellranger-atac v2 to remap fastq files to hg38. In each cell, we quantified the same set of peaks that were detected in the BMMC multiome dataset. After removing low-quality cells, 26,159 cells were retained, with total ATAC peaks of <50,000 and >2,000. We applied TF-IDF to normalize the ATAC-seq data. As this dataset was used as a query dataset in this manuscript, we did not perform unsupervised dimensionality reduction on the ATAC-seq data.

Data acquisition source: GEO, accession number GSE139369.







4. Human PBMC scRNA : PBMC 33k

This human PBMC scRNA dataset was obtained from the 10x Genomics website (https://www.10xgenomics.com/resources/datasets/) and consists of 33,015 cells. We retained cells with total RNA counts between 400 and 10,000. We applied log normalization for the gene expression matrix. We annotated these cells by mapping them to the Azimuth PBMC reference with the Seurat4 reference-mapping framework and refined the annotations by de novo clustering. These data were used for sketching benchmark analysis (Supplementary Fig. 5).

Data acquisition source: https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc33k.








5. Human PBMC mulitome 没下载
This human PBMC multiome (RNA + ATAC) dataset was obtained from the 10x Genomics website (https://www.10xgenomics.com/resources/datasets/) and consists of 10,970 cells. We retained cells with total RNA counts between 500 and 10,000 and total ATAC peak counts between 2,000 and 100,000. We applied SCTransform to normalize the gene expression data and TF-IDF to normalize ATAC peak counts. We annotated these cells by mapping the RNA profile to the Azimuth PBMC RNA reference with the Seurat4 reference-mapping framework. We then used these annotations to create ATAC-seq tracks, shown in Supplementary Fig. 2d.

Data acquisition source: https://www.10xgenomics.com/resources/datasets/10-k-human-pbm-cs-multiome-v-1-0-chromium-x-1-standard-2-0-0.







6. Human CD34+ bone marrow multiome

This human CD34+ bone marrow multiome (RNA + ATAC) dataset was obtained from Persad et al.84 and consists of 13,398 cells from two replicates. We retained cells with total RNA counts between 500 and 30,000 and total ATAC peak counts between 1,000 and 100,000. We used the same normalization method used for the human PBMC multiome. We annotated these cells by mapping the RNA profile to the Azimuth RNA BMMC reference with the Seurat4 reference-mapping framework. When using the human PBMC multiome dataset, we did not observe sufficient numbers of ASDCs to create a chromatin track for this dataset. However, we identified 12 cells annotated as ASDCs in these CD34+ bone marrow data. We used these cells to generate a chromatin track for the SIGLEC6 locus (Supplementary Fig. 2e), which validates our predicted ASDC identified via bridge integration.

Data acquisition source: https://zenodo.org/record/6383269.

Data is available for the following samples
    - CD34+ Multiome data : 2 replicates 
    - T-cell depleted bone marrow Multiome data: 2 replicates 

The following counts and fragments files are available for each replicate 
    - <sample>_filtered_feature_bc_matrix.h5: Feature counts from CellRanger ARC
        先下载该 h5 文件
    - <sample>_atac_fragments.tsv.gz: ATAC fragments file from Cellranger ARC
    - <sample>_atac_fragments.tsv.gz.tbi: Index files for ATAC fragments file from Cellranger ARC

The following scanpy anndata objects are also available
    - cd34_multiome_rna.h5ad: Anndata object with normalized data, cell type annotations and clusters for the RNA modality of CD34+ hematopoietic stem and progenitor cells 
        也可以直接使用这个：标准化后，带注释的，HSPC
    - cd34_multiome_atac.h5ad: Anndata object with peak counts, cell type annotations and clusters for the ATAC modality of of CD34+ hematopoietic stem and progenitor cells.
    - bm_multiome_rna.h5ad: Anndata object with normalized data, cell type annotations and clusters for the RNA modality of T-cell depleted bone marrow dataset.
        删除T细胞后的骨髓数据集
    - bm_multiome_atac.h5ad: Anndata object with peak counts, cell type annotations and clusters for the ATAC modality of T-cell depleted bone marrow dataset.

只下载最后的 h5ad 文件:
https://zenodo.org/records/6383269/files/BM_CD34_Rep1_filtered_feature_bc_matrix.h5?download=1
https://zenodo.org/records/6383269/files/BM_CD34_Rep2_filtered_feature_bc_matrix.h5?download=1
https://zenodo.org/records/6383269/files/cd34_multiome_rna.h5ad?download=1


https://zenodo.org/records/6383269/files/BM_Tcelldep_Rep1_filtered_feature_bc_matrix.h5?download=1
https://zenodo.org/records/6383269/files/BM_Tcelldep_Rep2_filtered_feature_bc_matrix.h5?download=1
https://zenodo.org/records/6383269/files/bm_multiome_rna.h5ad?download=1







7. Human PBMC CyTOF dataset | 47个抗体 的 PBMC 数据集
This human PBMC CyTOF dataset was generated by the COVID-19 Multi-omics Blood Atlas COMBAT consortium and consists of 7.11 million cells with a panel of 47 antibodies. We removed cells from individuals with sepsis, yielding a remainder of 5.17 million cells. We used the normalized expression matrices as quantified in the original study. As this dataset was used as a query dataset in this manuscript, we did not perform unsupervised dimensionality reduction on the protein data.

Data acquisition source: https://zenodo.org/record/5139561.


A blood atlas of COVID-19 defines hallmarks of disease severity and specificity: Associated data
Creators: COvid-19 Multi-omics Blood ATlas (COMBAT) Consortium1


This dataset contains raw and processed data from the COvid-19 Multi-omics Blood ATlas (COMBAT) consortium. Data are divided into 26 datasets representing anonymised raw and processed data from deep immune phenotyping of peripheral blood from COVID-19 patients. 

In addition to the data listed below, some datasets are available through other repositories: 

- Proteomics data (CBD-KEY-PROTEOMICS) is available at PRIDE
    * Accession number: PDX023175
    * Contact: Roman Fischer

- CITESeq annotations (CBD-KEY-ANNDATA) have also been made available through the COVID-19 Cell Atlas
    * https://www.covid19cellatlas.org/
    * Contact: Stephen Sansom

- Genetic data and detailed clinical information are available via a data access agreement through EGA
    * Study accession: EGAS00001005493 


CITESeq v1 data release from the COMBAT consortium.

For further information please see the publication https://www.medrxiv.org/content/10.1101/2021.05.11.21256877v1 or visit the consortium website: https://www.combat.ox.ac.uk. The raw data, clinical metadata and additional datasets are avaliable via the EGA and Zenodo (10.5281/zenodo.5139561). For further details and EGA accession numbers please see the STAR methods section of the publication. For more information please contact stephen.sansom@kennedy.ox.ac.uk.

Here two versions of the CITESeq dataset are shared:

(1) COMBAT-CITESeq-DATA.h5ad

This anndata object contains the raw and normalised gene expression and ADT data (symbols prefixed with "AB_"), cluster annotations, summary repertoire information and detailed metadata as reported and analysed in the COMBAT consortium paper "A blood atlas of COVID-19 defines hallmarks of disease severity and specificity" (https://www.medrxiv.org/content/10.1101/2021.05.11.21256877v1).


(2) COMBAT-CITESeq-EXPRESSION-ATLAS.h5ad

This anndata object contains the raw and normalised gene expression data from an alternative mapping to a transcriptome index that additionally included genes belonging to the "lncRNA" biotype. It also includes the ADT data, cluster annotations and a subset of the clinical metadata from (1). It is designed to be suitable for visualization with cellxgene.


COMBAT-CITESeq-DATA.h5ad 
    md5:87c6b1a733ea1adc37c808d9a357de74 	6.4 GB	
COMBAT-CITESeq-EXPRESSION-ATLAS.h5ad
    md5:ece5501a6b77f2c84a1747edbf6a170a 	6.6 GB	
Dataset_descriptions.pdf
    md5:280806d0f6ed878bd4684472e74d3efc 	279.0 kB

wget https://zenodo.org/records/5139561/files/COMBAT-CITESeq-DATA.h5ad
wget https://zenodo.org/records/5139561/files/COMBAT-CITESeq-EXPRESSION-ATLAS.h5ad
wget https://zenodo.org/records/5139561/files/Dataset_descriptions.pdf






8. Azimuth reference | BMMC, cortex
Azimuth scRNA-seq references for human bone marrow (297,627 cells) and the human motor cortex (159,738 cells) were downloaded from the HuBMAP portal. The portal includes descriptions of each public data source used when compiling the reference dataset and a link to a GitHub repository and Docker Hub to reproduce the construction of the reference.

- motor cortex 运动皮层：大脑皮层的一部分，参与运动控制和协调
- azimuth / ˈæzɪməθ / n.[测] 方位；[天] 方位角；偏振角


(1) Data acquisition source: https://azimuth.hubmapconsortium.org.

目前有 13 个分子图谱。
The development of Azimuth is led by the New York Genome Center Mapping Component as part of the NIH Human Biomolecular Atlas Project (HuBMAP). Thirteen molecular reference maps are currently available, with more coming soon.


(2) Program Snapshot | HuBMAP
https://commonfund.nih.gov/HuBMAP

The goal of the Human BioMolecular Atlas Program (HuBMAP) is to develop an open and global platform to map healthy cells in the human body.  In humans, the proper functioning of organs and tissues is dependent on the interaction, spatial organization, and specialization of all our cells.  Scientists estimate there are 37 trillion cells in an adult human body, so determining the function and relationship among these cells is a monumental undertaking.  Using the latest molecular and cellular biology technologies, HuBMAP researchers are studying the connections that cells have with each other throughout the body.  HuBMAP will build the framework necessary to construct the tools, resources, and cell atlases needed to determine how the relationships between cells can affect the health of an individual.


(3) PBMC
https://azimuth.hubmapconsortium.org/references/#Human%20-%20PBMC

来自 8 个自愿者，HIV疫苗试验后 0，3，7天。
This PBMC reference dataset was generated as part of the Hao and Hao et al, bioRvix 2020 paper. It is comprised of data from eight volunteers enrolled in an HIV vaccine trial from which three time point samples were taken at day 0, 3, and 7 following vaccination. 

24个样本都进行 CITE-seq，228 抗体的 single-cell RNA and ADT data。
All 24 samples were processed with a CITE-seq panel of 228 TotalSeq A antibodies to generate single-cell RNA and ADT data. 

使用WNN 联合RNA和蛋白。
The data were then integrated using metholody described in the pre-print linked above to generate a weighted nearest neighbor (WNN) representation of the RNA and protein data jointly. This WNN representation is used in the Azimuth app to assign celltypes, embed in the reference UMAP, and impute protein levels for the query dataset.

1) celltype.l1
Label	/Expanded Label	/OBO Ontology ID	/Markers
Mono	Monocyte	monocyte	CTSS, FCN1, NEAT1, LYZ, PSAP, S100A9, AIF1, MNDA, SERPINA1, TYROBP
CD4 T	CD4+ T cell	CD4-positive, alpha-beta T cell	IL7R, MAL, LTB, CD4, LDHB, TPT1, TRAC, TMSB10, CD3D, CD3G
CD8 T	CD8+ T cell	CD8-positive, alpha-beta T cell	CD8B, CD8A, CD3D, TMSB10, HCST, CD3G, LINC02446, CTSW, CD3E, TRAC
NK	natural killer cell	natural killer cell	NKG7, KLRD1, TYROBP, GNLY, FCER1G, PRF1, CD247, KLRF1, CST7, GZMB
B	B cell	mature B cell	CD79A, RALGPS2, CD79B, MS4A1, BANK1, CD74, TNFRSF13C, HLA-DQA1, IGHM, MEF2C
other T	other T cell	mature T cell	CD3D, TRDC, GZMK, KLRB1, NKG7, TRGC2, CST7, LYAR, KLRG1, GZMA
DC	dendritic cell	dendritic cell	CD74, HLA-DPA1, HLA-DPB1, HLA-DQA1, CCDC88A, HLA-DRA, HLA-DMA, CST3, HLA-DQB1, HLA-DRB1


2) celltype.l2 (default)
Label	/Expanded Label	/OBO Ontology ID	/Markers
B intermediate	/Intermediate B cell	/mature B cell	MS4A1, TNFRSF13B, IGHM, IGHD, AIM2, CD79A, LINC01857, RALGPS2, BANK1, CD79B
B memory	/Memory B cell	/memory B cell	MS4A1, COCH, AIM2, BANK1, SSPN, CD79A, TEX9, RALGPS2, TNFRSF13C, LINC01781
B naive	/Naive B cell	/naive B cell	IGHM, IGHD, CD79A, IL4R, MS4A1, CXCR4, BTG1, TCL1A, CD79B, YBX3
Plasmablast	/Plasmablast	/plasmablast	IGHA2, MZB1, TNFRSF17, DERL3, TXNDC5, TNFRSF13B, POU2AF1, CPNE5, HRASLS2, NT5DC2
CD4 CTL	/CD4+ Cytotoxic T	/CD4-positive, alpha-beta cytotoxic T cell	GZMH, CD4, FGFBP2, ITGB1, GZMA, CST7, GNLY, B2M, IL32, NKG7
CD4 Naive	/CD4+ Naive T	/naive thymus-derived CD4-positive, alpha-beta T cell	TCF7, CD4, CCR7, IL7R, FHIT, LEF1, MAL, NOSIP, LDHB, PIK3IP1
CD4 Proliferating	/CD4+ Proliferating T	/activated CD4-positive, alpha-beta T cell	MKI67, TOP2A, PCLAF, CENPF, TYMS, NUSAP1, ASPM, PTTG1, TPX2, RRM2
CD4 TCM	/CD4+ Central Memory T	/CD4-positive, alpha-beta memory T cell	IL7R, TMSB10, CD4, ITGB1, LTB, TRAC, AQP3, LDHB, IL32, MAL
CD4 TEM	/CD4+ Effector Memory T	/effector CD4-positive, alpha-beta T cell	IL7R, CCL5, FYB1, GZMK, IL32, GZMA, KLRB1, TRAC, LTB, AQP3
Treg	/Regulatory T	/regulatory T cell	RTKN2, FOXP3, AC133644.2, CD4, IL2RA, TIGIT, CTLA4, FCRL3, LAIR2, IKZF2
CD8 Naive	/CD8+ Naive T	/naive thymus-derived CD8-positive, alpha-beta T cell	CD8B, S100B, CCR7, RGS10, NOSIP, LINC02446, LEF1, CRTAM, CD8A, OXNAD1
CD8 Proliferating	/CD8+ Proliferating T	/activated CD8-positive, alpha-beta T cell	MKI67, CD8B, TYMS, TRAC, PCLAF, CD3D, CLSPN, CD3G, TK1, RRM2
CD8 TCM	/CD8+ Central Memory T	/CD8-positive, alpha-beta memory T cell	CD8B, ANXA1, CD8A, KRT1, LINC02446, YBX3, IL7R, TRAC, NELL2, LDHB
CD8 TEM	/CD8+ Effector Memory T	/effector CD8-positive, alpha-beta T cell	CCL5, GZMH, CD8A, TRAC, KLRD1, NKG7, GZMK, CST7, CD8B, TRGC2
ASDC	/AXL+ Dendritic Cell	/dendritic cell	PPP1R14A, LILRA4, AXL, IL3RA, SCT, SCN9A, LGMN, DNASE1L3, CLEC4C, GAS6
cDC1	/Conventional Dendritic Cell 1	/CD141-positive myeloid dendritic cell	CLEC9A, DNASE1L3, C1orf54, IDO1, CLNK, CADM1, FLT3, ENPP1, XCR1, NDRG2
cDC2	/Conventional Dendritic Cell 2	/CD1c-positive myeloid dendritic cell	FCER1A, HLA-DQA1, CLEC10A, CD1C, ENHO, PLD4, GSN, SLC38A1, NDRG2, AFF3
pDC	/Plasmacytoid Dendritic Cell	/plasmacytoid dendritic cell	ITM2C, PLD4, SERPINF1, LILRA4, IL3RA, TPM2, MZB1, SPIB, IRF4, SMPD3
CD14 Mono	/CD14+ Monocyte	/CD14-positive, CD16-negative classical monocyte	S100A9, CTSS, S100A8, LYZ, VCAN, S100A12, IL1B, CD14, G0S2, FCN1
CD16 Mono	/CD16+ Monocyte	/CD14-low, CD16-positive monocyte	CDKN1C, FCGR3A, PTPRC, LST1, IER5, MS4A7, RHOC, IFITM3, AIF1, HES4
NK	/CD56-dim Natural Killer	/CD16-positive, CD56-dim natural killer cell, human	GNLY, TYROBP, NKG7, FCER1G, GZMB, TRDC, PRF1, FGFBP2, SPON2, KLRF1
NK Proliferating	/Proliferating Natural Killer	/natural killer cell	MKI67, KLRF1, TYMS, TRDC, TOP2A, FCER1G, PCLAF, CD247, CLSPN, ASPM
NK_CD56bright	/CD56-bright Natural Killer	/CD16-negative, CD56-bright natural killer cell, human	XCL2, FCER1G, SPINK2, TRDC, KLRC1, XCL1, SPTSSB, PPP1R9A, NCAM1, TNFRSF11A
Eryth	/Erythroid cell	/erythroid lineage cell	HBD, HBM, AHSP, ALAS2, CA1, SLC4A1, IFIT1B, TRIM58, SELENBP1, TMCC2
HSPC	/Hematopoietic stem and progenitor cell	/hematopoietic precursor cell	SPINK2, PRSS57, CYTL1, EGFL7, GATA2, CD34, SMIM24, AVP, MYB, LAPTM4B
ILC	/Innate Lymphoid Cell	/innate lymphoid cell	KIT, TRDC, TTLL10, LINC01229, SOX4, KLRB1, TNFRSF18, TNFRSF4, IL1R1, HPGDS
Platelet	/Platelet	/platelet	PPBP, PF4, NRGN, GNG11, CAVIN2, TUBB1, CLU, HIST1H2AC, RGS18, GP9
dnT	/Double-negative T	/CD4-negative, CD8-negative, alpha-beta intraepithelial T cell	PTPN3, MIR4422HG, NUCB2, CAV1, DTHD1, GZMA, MYB, FXYD2, GZMK, AC004585.1
gdT	/gamma-delta T	/gamma-delta T cell	TRDC, TRGC1, TRGC2, KLRC1, NKG7, TRDV2, CD7, TRGV9, KLRD1, KLRG1
MAIT	/Mucosal associated invariant T	/mucosal invariant T cell	KLRB1, NKG7, GZMK, IL7R, SLC4A10, GZMA, CXCR6, PRSS35, RBM24, NCR3



(4) BMMC 
https://azimuth.hubmapconsortium.org/references/#Human%20-%20Bone%20Marrow

Label	Expanded Label	OBO Ontology ID	Markers
B	B	lymphocyte of B lineage	FCRL1,FCRL2,CD22,ARHGAP24,BANK1,MS4A1,RALGPS2,CD37,SWAP70,CD79A
CD4 T	CD4 T	CD4-positive, alpha-beta T cell	MAL,LEF1,IL7R,TCF7,LTB,LEPROTL1,CD3E,CD3D,CD3G,CD27
CD8 T	CD8 T	CD8-positive, alpha-beta T cell	CD8B,CD8A,NELL2,CD3D,CD3E,S100B,GZMH,CD3G,TRGC2,CCL5
DC	Dendritic Cell	dendritic cell	CLEC4C,PROC,SCT,SCN9A,SHD,PPM1J,ENHO,CLEC10A,LILRA4,DNASE1L3
HSPC	Hematopoeitic stem and progenitor cell	hematopoietic precursor cell	ARPP21,CFAP73,AVP,SPTA1,EPCAM,RHCE,AKAP12,RHAG,C1QTNF4,CYTL1
Mono	Monocyte	monocyte	LYPD2,FOLR3,CLEC4E,LILRA1,CDA,RBP7,CD300LF,FPR1,CD93,MTMR11
NK	Natural Killer	mature NK cell	NCR1,SH2D1B,KLRC1,PRSS23,CD160,B3GNT7,IL2RB,IL18RAP,XCL1,KLRF1
Other T	Other T	T cell	SLC4A10,KLRB1,IL7R,TNFRSF25,RORA,SPOCK2,MAF,GZMK,ZFP36L2,LYAR

太小，玩具
$ wget https://seurat.nygenome.org/azimuth/demo_datasets/bmcite_demo.rds -O azimuth_bmcite_demo.rds


https://zenodo.org/records/5521512
Azimuth Reference - Human BMMC
Creators: Satija Lab1
Description: Here we provide the reference data files used to run the Azimuth Human BMMC reference web application. For a full description of the reference data structure, please see the wiki at https://github.com/satijalab/azimuth/wiki/Azimuth-Reference-Format.

Name md5	Size	
idx.annoy   md5:a4638a147b3334ecfc71ce00ed72d9f0 	272.8 MB	
ref.Rds md5:61bfb8a271516734364e00c361d3223c 	228.7 MB	

wget https://zenodo.org/records/5521512/files/idx.annoy?download=1 -O azimuth_BMMC_idx.annoy
wget https://zenodo.org/records/5521512/files/ref.Rds?download=1 -O azimuth_BMMC_ref.Rds

md5 pass!









========================================
鼻咽癌细胞癌: nasopharyngeal carcinoma
----------------------------------------

1. 鼻咽癌细胞分类
# https://www.nature.com/articles/s41422-020-0374-x

We then annotated the clusters by the average expression of curated gene sets of the following major cell types:
- epithelial cells (EPCAM, KRT19, KRT18, KRT5, and KRT15),
- myeloid cells (LYZ, CD68, MS4A6A, CD1E, IL3RA, and LAMP3),
- T cells (CD2 and CD3D/E/G),
- B cells (CD79A/B, CD19, and MS4A1),
- and CAFs (COL1A1, COL3A1, and DCN).


(2) Novel myeloid cell subtypes and regulators underlying monocyte-macrophage differentiation in NPC
In total, 5191 myeloid cells were clustered into six separate subsets (Fig. 3a):
macrophages, monocytes, pDCs, CLEC9A+ DCs (DC1), CD1C+ DCs (DC2), and CCR7+ DCs (DC3) (Fig. 3b).

- Notably, DC1 expressed many of the classic markers of conventional type 1 DCs (cDC1),
	* including CLEC9A, IRF8, and IDO1 (Fig. 3c).
	* cDC1 constitute the key DC subtype responsible for cross-priming antitumor CD8+ T cells and are critical in antitumor immunity.

- DC3 expressed markers, such as CCR7, LAMP3, FSCN1, and CCL19, that have been associated with DC activation.
	* Of these markers, CCL19 is known to attract naïve T cells as well as other DCs by interacting with CCR7 (Fig. 3c).

- DC2 preferentially expressed a series of classic marker genes of conventional type 2 DCs (cDC2), including CD1E, FCER1A and CLEC10A (Fig. 3c).


(3)
Of these clusters, one consisted of rarely reported FCRL4+ memory B cells, in which elevated CCR1 expression supports the homing of these cells to inflamed tissues.






========================================
PBMC 细胞类型 marker: 血液
----------------------------------------

1. [2020]Single-Cell Analyses Identify Dysfunctional CD16+ CD8 T Cells in Smokers
BPMC markers: https://www.sciencedirect.com/science/article/pii/S2666379120300707

Cells in clusters expressing CD3D as a positive marker were designated as T cells
	- T cells were further classified into CD4 T cells, CD8 T cells, or NKT cells based on the expression of CD4, CD8A, or NCR3;

NK cells were identified based on CD3D as a negative marker combined with the expression of NKG7, GNLY, GZMB, PRF1, and NCR3 as positive markers.

Monocytes were positive for LYZ and either CD14 or FCGR3A (encodes CD16), characteristic of classical or nonclassical monocytes.

DCs were similar to monocytes but could be distinguished by the expression of FCER1A.

B cells were defined by MS4A1 (encodes CD20): CD79A, CD79B;



2. []Single-cell transcriptomics of human T cells reveals tissue and activation signatures in health and disease
https://www.nature.com/articles/s41467-019-12464-3




3. [2019]Single-cell RNA sequencing unveils the shared and the distinct cytotoxic hallmarks of human TCRVδ1 and TCRVδ2 γδ T lymphocytes

https://www.pnas.org/content/pnas/116/24/11906.full.pdf




4. PBMC 分为13个亚群
Nucleic Acids Res. 2018 Apr ，dropClust: efficient clustering of ultra-large scRNA-seq data
https://mp.weixin.qq.com/s?__biz=MzI1Njk4ODE0MQ==&mid=2247486271&idx=1&sn=638b434b6deee63206af1c0eeda175ab

Naive T cells: CD27, CCR7, CD8A, CD8B;
CD4+ memory cells: IL7R, CD27, CCR7;
NKT cells: ZNF683, CD8A, CD8B
B cells: CD79A, CD37;
CD8+ T cells: GZMK, CD8A, CD8B;
NK cells: CD160, NKG7, GNLY, CD247, CCL3, GZMB;
CD16+ and CD14+ monocytes: CD68, CD16(FCGR3A), CD14, S100A12;
Regulatory T cells: CCR10, CD25(IL2RA), CD52, CMTM7, FOXP3;
Monocyte derived dendritic cells: CST3, CD1C, FCER1A;
Megakaryocyte progenitors: PF4, PPBP, PLA2G12A;
Progenitor-NK cells: ID2;
Plasmacytoid dendritic cells: GZMB, CD123(IL3RA);




### gene study

# TNFRSF4 Gene (OX40)
Receptor for TNFSF4/OX40L/GP34. Is a costimulatory molecule implicated in long-term T-cell immunity.

Knockout studies in mice suggested that this receptor promotes the expression of apoptosis inhibitors BCL2 and BCL2lL1/BCL2-XL, and thus suppresses apoptosis.
The knockout studies also suggested the roles of this receptor in CD4+ T cell response, as well as in T cell-dependent B cell proliferation and differentiation.
在CD4+ T-cell细胞响应中，在T细胞依赖的B细胞分裂和分化中起作用。




4. PBMC markers in a png
https://onek1k.org/cell-types
from https://pubmed.ncbi.nlm.nih.gov/35389779/
  Single-cell eQTL mapping identifies cell type-specific genetic control of autoimmune disease




5.




========================================
BMMC 细胞类型 marker: 骨髓
----------------------------------------
1. human
pre_B	 VPREB1	 VPREB3
pro_B	 CD79A	 CD79B
B_cell_related_genes	 MS4A1	 IGHD	 CD19	 IGKC
pro_NK_T	 NKG7	 DNTT	 ACY3	 MLXIP
pro_megakaryocyte	 ITGA2B	 CD41	 CD9	 PF4	 PPBP	 PLEK
pro_basophil	 GATA2	 LMO4	 MS4A2	 TPSB2	 RNF130
CD34_p_erythrocyte_progenitors	 GATA1	 KLF1	 MYC	 TFRC	 CD71	 HBB	 HBD
pro_eosinophil	 PGR2	 RNase2	 EDN	 RNase3	 ECP	 CST7	 CEBPE	 CSF3R	 CD114	 CD177	 S100A9	 S100A8	 S100P
pro_neutrophil	 RNase2	 EDN	 RNase3	 ECP	 CST7	 CEBPE	 CSF3R	 CD114	 CD177	 S100A9	 S100A8	 S100P
pro_monocyte	 LYZ	 CD14	 CSF1R	 MS4A7	 FCN1	 MNDA
pro_dendritic	 CD74	 STAT1	 ID2	 IRF8	 HLA-DRB	 HLA-DRA	 HLA-DPA	 HLA-DPB	 HLA-DQ
pro_Langerhans_dendritic	 CXCL2
cell_cycle	 TK1	 PCNA
HSPC	  CD34	 SPINK2	 SOX4
granulocyte	 MPO
mature_NK	 GZMH	 GZMA	 GZMB
T_cell	 CD3	 CD8	 CXCR4	 CD69


(2) from paper: bone marrow mononuclear cells (BMMCs)
https://www.nature.com/articles/s41421-020-00223-4 QinPengfei

1.39% HSPCs (AVP and CD34), 
10.15% erythroid progenitor cells (EPCs) (GYPA and KLF1), 
0.08% megakaryocytes (Mk) (PF4 and GP9), 
1.25% myelocytes (ELANE and MPO), 
2.91% monocytes (LYZ and CD14), 
17.67% B cells (CD79A), 
53.11% T cells (CD3D), 
11.62% natural killer cells (NK) (FCGR3A and NCAM1), 
0.04% stromal cells (CXCL12 and COL6A1).


myelocyte [ˈmaɪələʊsaɪt] n. [组织] 髓细胞；[细胞] 中幼粒细胞
megakaryocyte [ˌmeɡəˈkærɪəˌsaɪt] n. [组织] 巨核细胞








2. mouse
mouse: Hba-a1, Hba-a2, Hbb-bt
pro_basophil	 Prss34










========================================
人体肠道 (Cells of the human intestinal tract mapped across space and time)
----------------------------------------

https://www.nature.com/articles/s41586-021-03852-1/figures/6














========================================
*** leucocyte 白细胞(CD45+)分化路径 ***
----------------------------------------
==> for mouse https://www.cellsignal.com/pathways/immune-cell-markers-mouse
==> for human https://www.cellsignal.com/pathways/immune-cell-markers-human
leucocyte 白细胞(CD45+)
    髓系细胞 (CD11b+)
        monocyte 
        macrophage 
            M1-like: iNOS+
            M2-like: CD163+ or CD206+
        cDC: conventional Dendritic cells 
            cDC1
            cDC2
        pDC: plasmacytoid Dendritic cells 
        MDSC: Myeloid-derived supressor cells
            Monocytic(M) MDSCs
            Polymorphonuclear(PMN) MDSCs
        粒细胞
            中性粒细胞  
            嗜酸性粒细胞 
            嗜碱性粒细胞 
            肥大细胞
    淋系细胞
        B细胞 
        plasma cell: 浆细胞
        T细胞
        NK 细胞:
            CD56 low 
            CD56 high
        NKT 
            type I NKT: iNKT 
            type II NKT:
        

髓系来源抑制细胞：一种具有免疫抑制功能的髓系细胞，可以抑制T细胞的活性，从而影响免疫应答。




# T Cells (CD3D, CD3E, CD8A),
# B cells (CD19, CD79A, MS4A1 [CD20]),
# Plasma cells (IGHG1, MZB1, SDC1, CD79A),
# Monocytes and macrophages (CD68, CD163, CD14),
# NK Cells (FGFBP2, FCG3RA, CX3CR1),
# Photoreceptor cells (RCVRN),
# Fibroblasts (FGF7, MME),
# Endothelial cells (PECAM1, VWF).
# epi or tumor (EPCAM, KRT19, PROM1, ALDH1A1, CD24).


immune (CD45+, PTPRC),
epithelial/cancer (EpCAM+, EPCAM),
stromal (CD10+, MME, fibo or CD31+, PECAM1, endo)





1. NCI Dictionary of Cancer Terms 肿瘤词典
https://www.cancer.gov/publications/dictionaries/cancer-terms

(1). macrophage (MA-kroh-fayj)
https://www.cancer.gov/publications/dictionaries/cancer-terms/def/macrophage
A type of white blood cell that surrounds and kills microorganisms, removes dead cells, and stimulates the action of other immune system cells.

Blood cells. Blood contains many types of cells: white blood cells (monocytes, lymphocytes, neutrophils, eosinophils, basophils, and macrophages), red blood cells (erythrocytes), and platelets. Blood circulates through the body in the arteries and veins.




========================================
|-- CD 分子及其意义
----------------------------------------
1. 信息源: 审稿 supp
(1) Supplementary Table 3. Antibody-Derived Tags (ADT) used in single-cell CITE-seq
Name Barcode Description BioLegend Cat. No. Clone
ADT-CD14 TCTCAGACCTCCGTA TotalSeq™-A0081 anti-human CD14 Antibody 301855 M5E2
ADT-CD64 AAGTATGCCCTACGA TotalSeq™-A0162 anti-human CD64 Antibody 305037 10.1
ADT-CD22 GGGTTGTTGTCTTTG TotalSeq™-A0393 anti-human CD22 Antibody 363514 S-HCL-1
ADT-CD10 CAGCCATTCATTAGG TotalSeq™-A0062 anti-human CD10 Antibody 312231 HI10a
ADT-CD13 TTTCAACGCCCTTTC TotalSeq™-A0364 anti-human CD13 Antibody 301729 WM15
ADT-CD117 AGACTAATAGCTGAC TotalSeq™-A0061 anti-human CD117 (c-kit) Antibody 313241 104D2
ADT-CD5 CATTAACGGGATGCC TotalSeq™-A0138 anti-human CD5 Antibody 300635 UCHT2
ADT-CD7 TGGATTCCCGGACTT TotalSeq™-A0066 anti-human CD7 Antibody 343123 CD7-6B7
ADT-CD56 TTCGCCGCATTGAGT TotalSeq™-A0084 anti-human CD56 (NCAM) Recombinant Antibody 392421 QA17A16
ADT-HLA-DR AATAGCGAGCAAGTA TotalSeq™-A0159 anti-human HLA-DR Antibody 307659 L243
ADT-CD11b GACAAGTGATCTGCA TotalSeq™-A0161 anti-human CD11b Antibody 301353 ICRF44
ADT-CD4 GCGATCCCTTGAGAT TotalSeq™-A0922 anti-human CD4 Antibody 317451 OKT4
ADT-CD3 TATCCCTTGGGATGG TotalSeq™-A0049 anti-human CD3 Antibody 344847 SK7
ADT-CD19 CTGGGCAATTACTCG TotalSeq™-A0050 anti-human CD19 Antibody 302259 HIB19
ADT-CD30 TCAGGGTGTGCTGTA TotalSeq™-A0028 anti-human CD30 Antibody 333913 BY88
ADT-CD33 TAACTCAGGGCCTAT TotalSeq™-A0052 anti-human CD33 Antibody 366629 P67.6
ADT-CD45 TGCAATTACCCGGAT TotalSeq™-A0391 anti-human CD45 Antibody 304064 HI30
ADT-CD34 GCAGAAATCTCCCTT TotalSeq™-A0054 anti-human CD34 Antibody 343537 581

ADT-IgG1 GCCGGACGACATTAA TotalSeq™-A0090 Mouse IgG1, κ isotype Ctrl Antibody 400199 MOPC-21


(2) Supplementary Table 10. Antibody-Oligo Conjugates (AOCs) for SC DNA+Protein sequencing
Product Name barcode
CD3 AACGCTTC
CD4 CGGTTACA
CD5 CCACTTAG
CD7 GCCAAGTT
CD8 CGACAAGA
CD10 TGGCAGAA
CD11b ATGTAGCC
CD13 ACGGAATG
CD14 TGTGACGT
CD15 AACCGAGA
CD16 ACAAGGAC
CD19 ACTGCCAA
CD22 AAGGTGGT
CD30 AGGTCCTA
CD33 GGAACCAT
CD34 CAGAGCTA
CD38 ACCTCACT
CD56 CCTTGATC
CD64 AACAACCG
CD71 AGATTCGC
CD117 TTCGTTGG
CD123 GATGGTCA
CD45-26 AGTGGTAC
CD45-27 ATTGGCTG
CD45-28 CAGTCGAA
        CATACAGG




2. 解释这几个抗体的意义

(1) 
CD3用于T细胞标记、CD4用于辅助T细胞标记、CD8用于细胞毒性T细胞标记。

CD45，总淋巴细胞标记，在淋巴细胞的发育成熟，功能调节及信号传递中具有重要意义，其分布可作为某些T细胞亚群的分类标志。
CD3，T细胞表面标记，主要功能是促进细胞毒性T细胞（CD8+ T细胞）和辅助T细胞（CD4+ T细胞）的活化，并最终帮助形成获得性免疫反应。
CD4，CD4+ T细胞，属于淋巴细胞分类中的辅助T细胞，直接反应机体免疫力功能的强弱，CD4+ T细胞是HIV感染过程中的主要靶点。
CD8，CD8+ T细胞，细胞毒性T淋巴细胞（CTL），专门分泌各种细胞因子参与免疫作用。对某些病毒、肿瘤细胞等抗原物质具有杀伤作用，与自然杀伤细胞构成机体抗病毒、抗肿瘤免疫的重要防线。
CD5，表达于T淋巴细胞和部分B淋巴细胞上，CD5+的T淋巴细胞有信号转达功能，CD5+的B淋巴细胞除具有免疫功能外，还与疾病发生密切相关。

CD21，表达于滤泡树突状细胞（FDC）和B淋巴细胞，主要用于标记B细胞及其来源的肿瘤。

CD14，细菌脂多糖的膜受体，与LPS结合，引起细胞酪氨酸磷酸化、核因子NF-κB转位、触发细胞因子释放和氧自由基产生。
    monocyte 
CD16，主要表达于：NK细胞、嗜中性多形核白细胞、单个核细胞和巨噬细胞。
    monocyte 
CD23，一种低亲和力IgE受体，主要表达于成熟的B细胞和滤泡树突状细胞。

T 细胞: CD2, CD3, CD4, CD5, CD8, CD28, CD152(CTLA-4), CD154(CD40L), CD272(BTLA), CD278(ICOS), CD294(CRTH2)
B 细胞: CD19, CD20, CD21, CD40, CD79a(Ig alpha), CD79b(Ig beta), CD80(B7-1), CD86(B7-2), CD267(TACI), CD268(BAFFR), CD269(BCMA), CD307(IRTA2)
髓样细胞: CD14, CD35(CR1), CD64(FcrRI), CD256(APRIL), CD257(BAFF), CD312(EMR2)


HLA-DR基因属于 II 型MHC基因，主要表达于成熟B细胞、抗原递呈细胞、血管内皮细胞及T细胞表面。在免疫系统中起提呈抗原多肽给Th细胞的重要功能，其在细胞表面的抗原分子浓度是影响免疫应答的重要参数之一。


(2) Table1. CD markers for immunophenotyping
https://www.creativebiomart.net/cluster-of-differentiation.htm

Type of cell	/CD markers
Stem cells	CD34+, CD31-, CD117
all leukocyte groups	CD45+
Granulocyte	CD45+, CD11b, CD15+, CD24+, CD114+, CD182+
Monocyte	CD4, CD45+, CD14+, CD114+, CD11a, CD11b, CD91+, CD16+
T lymphocyte	CD45+, CD3+
T helper cell	CD45+, CD3+, CD4+
T regulatory cell	CD4, CD25, FOXP3 (a transcription factor)
Cytotoxic T cell	CD45+, CD3+, CD8+
B lymphocyte	CD45+, CD19+, CD20+, CD24+, CD38, CD22
Thrombocyte	CD45+, CD61+
Natural killer cell	CD16+, CD56+, CD3-, CD31, CD30, CD38


https://www.creativebiomart.net/cluster-of-differentiation.htm
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7158181/

CD5	a type I transmembrane protein found on T cells, thymocytes, and some B cells that is a ligand for CD72 and is involved in cellular activation or adhesion; expressed in B-cell chronic lymphocytic leukemia and T-cell lymphoma.

CD7	a type I transmembrane protein found on thymocytes, some T cells, monocytes, natural killer cells, and hematopoietic stem cells; expressed in patients with mycosis fungoides, some patients with T-cell acute lymphoblastic leukemia, and a few patients with acute nonlymphocytic leukemia

CD10	a type II transmembrane protein found on pre-B cells, germinal-center B cells, some neutrophils, kidney cells, T-cell precursors, and epithelial cells that acts as a zinc metalloprotease cleaving peptide bonds on the amino side of hydrophobic amino acids; expressed in acute lymphocytic leukemia and follicular-center-cell lymphomas.

CD13	a zinc metalloproteinase, also known as aminopeptidase N, which is found naturally on myelomonocytic cells from early differentiation through maturity; usually present on acute myeloid leukemia blasts and rarely found in some forms of lymphoma and lymphocytic leukemia

CD14	a membrane protein found on macrophages which binds to bacterial lipopolysaccharide.

CD15	a carbohydrate adhesion molecule (not a protein) that mediates phagocytosis and chemotaxis, found on neutrophils; expressed in patients with Hodgkin disease, some B-cell chronic lymphocytic leukemias, acute lymphoblastic leukemias, and most acute nonlymphocytic leukemias. It is also called Lewis x and SSEA-1 (stage specific embryonic antigen 1) and represents a marker for murine pluripotent stem cells, in which it plays an important role in adhesion and migration of the cells in the preimplantation embryo.
- Neutrophils, eosinophils, monocytes, Reed Sternberg cells

CD30	a type I transmembrane protein present on activated T and B cells that may play a role in cell activation and/or differentiation; expressed in Hodgkin disease, some T-cell lymphomas, and anaplastic large cell lymphomas.

CD33	a marker of unknown function found on immature myeloid cells, including acute myeloid leukemia blasts and mature monocytes. Anti-CD33 monoclonal antibodies are extensively used for the diagnosis of all types of AMLs.

CD38	involved in ecto-ADP-ribosyl cyclase and cell activation on many hematopoietic, plasma, and B & T activated cells; marker increases with HIV seroconversion, coexpression with CD8 associated with progression (indicates persistent viral stimulation). Some antibodies targeting CD38 are being tested in multiple myeloma and non-Hodgkin's lymphoma e.g. Daratumumab or Celgene's MOR202.
- Plasma cells, majority of hemopoietic cells

CD56	140 kD isoform of NCAM (neural cell adhesion molecule), a marker for natural killer cells and some T-lymphocytes

CD64a	Commonly known as Fc-gamma receptor 1 (FcγRI) with high-affinity to IgG. CD64 is found on macrophages and monocytes.
CD64 	Monocytes, macrophages, dendritic cell subset

CD71	Transferrin receptor (Transferrin receptor protein 1 - TfR1), mediates cellular uptake of iron. Ubiquitously expressed on dividing, normal (haematological precursors) and malignant cells. Currently investigated as a target for an antibody ("probody") drug conjugate from Cytomx / Abbvie to treat various cancers.

CD123	Also known as interleukin-3 receptor (IL-3R), is a molecule found on cells which helps transmit the signal of interleukin-3, a soluble cytokine important in the immune system. It is found on pluripotent progenitor cells, induces tyrosine phosphorylation within the cell, and promotes proliferation and differentiation within the hematopoietic cell lines.
- Myeloid cells including early progenitors endothelial cells



(3)
https://www.abcam.com/primary-antibodies/human-cd-antigen-guide

CD117   Hematopoietic and lymphoid cell types, such as dendritic cells, NK cells and mast cells.



(a) 第一批
CD45, CD3, CD4, 
    CD5
    CD7
    CD30
    CD56 (NCAM)
CD11b, CD14, CD33
    CD13
    CD64
CD19, CD22
    CD10
CD34, CD117 (c-kit)

HLA-DR




(b) 第二批
CD45, CD4, CD8
    CD5
    CD7
    CD30
    CD56
CD11b, CD16, CD14, CD33
    CD13
    CD15
    CD64
    CD123
CD19, CD22
    CD10
    CD38
CD34, CD117
CD71 红系祖细胞

(c) test on BMMC scRNA-seq dataset 
#T    CD5, CD7,  TNFRSF8(CD30)?, NCAM1(CD56)?
#mono CD33, ANPEP(CD13), FCGR1A(CD64), FUT4(CD15)?, IL3RA(CD123)
#B    MME(CD10), CD38	
#ery  TFRC(CD71),
#hsc CD34, KIT(CD117), 


ref: https://zhuanlan.zhihu.com/p/590781947?utm_id=0








========================================
淋系发育路径：B, T, ILC(NK, )
----------------------------------------
先天性淋巴细胞（Innate lymphoid cell, ILC），包括 NK



========================================
|-- B cell marker & plasma cell 浆细胞
----------------------------------------
https://www.rndsystems.com/cn/research-area/b-cell-markers

1. 正常B细胞的发育和分化途径
https://mp.weixin.qq.com/s?__biz=MjM5MTU2Njg4MA==&mid=2651823592&idx=1&sn=12a92d156920cb604642572111e90d55
B1和 B2是两个独立分化的B细胞谱系，B2细胞是主流，在识别抗原并接受适当的 T 细胞辅助时，可以分化为短寿命PC、记忆B细胞或长寿命PC，B1细胞虽然相对少，但亦是体液免疫不可缺少的一部分。

摘自：Eva Schrezenmeier, David Jayne, Thomas Dörner. Targeting B Cells and Plasma Cells in Glomerular Diseases: Translational Perspectives. JASN Mar 2018, 29 (3) 741-758; DOI: 10.1681/ASN.2017040367




2. mouse atlas2 
> b1=FindMarkers(atlas2, ident.1 = "B cell")
["Fcmr","Ralgps2","Fcrla","Pkig","Xist","Tifa","Bank1","Bach2","Cd72","Pax5","Rhoh","Gm30211","Igkc","Foxp1","Cd79a","Pou2f2","Pafah1b3","Siglecg","Spib","Cd37","Cd19","Chchd10","Vpreb3","Pou2af1","Ebf1","Cnp","Dnajc7","Cd79b","Sox4","Mef2c","Ighd","Ighm","Ptp4a3","Ly6d","Apobec3","Tnfrsf13c","Iglc1","Iglc3","Iglc2","H2-DMb2","H2-Ob","H2-Ab1","H2-Aa","H2-Eb1","Mzb1","Cd74","Ptprcap","Ms4a1","Blnk","Igha"] 




3. HNSCC 
(1) pre-B(cluster5)
["CD79A","MS4A1","CD37","AL928768.3","HLA-DRA","HLA-DQB1","BANK1","LAPTM5","HLA-DQA1","CD74","LY9","CD83","VPREB3","TNFRSF13C","CD79B","HLA-DPB1","CD52","CD19","TNFRSF13B","LTB","CD69","HLA-DPA1","MEF2C","CCR7","HLA-DMA","CD48","LY86","LIMD2","EZR","SMIM14","WDR74","HLA-DQA2","RP5-887A10.1","HLA-DMB","SPIB","HLA-DRB1","HLA-DRB5","REL","IRF8","CD53","ADAM28","ISG20","YPEL5","POU2F2","KIAA0226L","GPSM3","RHOH","CD22","CORO1A","SELL","ORAI2","BCAS4","RPLP2","EEF1B2","EVI2B","NCF1","FCRLA","RPSA","CXCR4","BLK","IGHD","FCMR","RPS23","RPS27","RPS29","SMAP2","LYN","HLA-DOB","TSC22D3","GNG7"] 

VPREB3


(2) plasma B cell?
# common
["IGHG4","IGHG1","IGHG3","IGHG2","IGHM","IGHA1","IGHGP","JCHAIN","IGHA2","MZB1","DERL3","SSR4","XBP1","FKBP11","IGLV3-1","CD79A","HERPUD1","SEC11C","PRDX4","JSRP1","DNAAF1","ITM2C","PIM2","SDF2L1","FKBP2","SPCS3","HSP90B1","PLPP5","SPAG4","DNAJB9","CRELD2","HIST1H1C","TRIB1","ANKRD28","ERLEC1","FCRL5","TNFRSF17","HIST1H2BG","TXNDC15","IGLV6-57","ZBP1","GNG7","KIAA0125","RAB30","RP11-16E12.2","MEI1","CD38","CHST2","TXNDC11","PRDM1","RP11-290F5.1","CD27","POU2AF1","SLAMF7","MANF","SSR3","SPCS2","VIMP"] 

# c7-c9: 免疫球蛋白轻链 kappa 恒定区(immunoglobulin kappa constant,IGKC)
["IGKC","IGKV1-12","IGKV4-1","IGKV1-5","IGKV3-20","DPEP1","FAM92B","RNU12","CADM1","CHPF","PTP4A3","CYBA"] 

# c9-c7: 免疫球蛋白轻链 lambda(IgLC3)
["IGLC3","IGLC2","IGLC7","IGLL5","IGLV2-14","IGLC6","AL928768.3","IGLL1","LMAN1","UBE2J1","PDIA4","MYDGF"]










========================================
|-- T cell: CD4+T, CD8+T
----------------------------------------
1. mouse atlas2
> b1=FindMarkers(atlas2, ident.1 = "T cell")

["Cd28","Bcl2","Rpl12","Rpl35","Rpl36a","Rps27","Cd2","Rps6","Lck","Trbc1","Trbc2","Gimap4","Gimap6","Gimap3","Cd8b1","Tmsb10","Rps5","Rps19","Nkg7","Rpl13a","Rps15a","Lat","Rplp2","Rps15","Uba52","Trac","Thy1","Cd3g","Cd3d","Cd3e","Rplp1","Rpl4","Shisa5","Rpl14","Rpl23a","Ccl5","Skap1","Rpl27","Rps23","Rps7","Il7r","Rpl3","Rps28","Rps18","H2-Q7","Rpl36","Rps14","AW112010","Ms4a4b","Ms4a6b"] 




2. HNSCC 

(1) T cell
"CD3D", "CD3E", "CD4", "CD8A", "CD8B", "SELL",

> scObj.markers %>% group_by(cluster) %>%
    filter(cluster %in% c(1,2,8) ) %>%  #by cluster
    top_n(n = 30, wt = avg_log2FC) %>% #arrange( desc(pct.1) ) %>%
    pull("gene") %>% unique() %>% jsonlite::toJSON()
["TNFRSF4","LTB","TRAC","IL32","TNFRSF18","CD2","SPOCK2","TRBC1","IL7R","TRBC2","ICOS","BATF","RGCC","CD3D","CD3E","SARAF","KLRB1","CD7","CREM","ARHGDIB","BTG1","SRGN","RHOH","LEPROTL1","FXYD5","CXCR4","TIGIT","CCR7","PTPRC","IL2RG","GNLY","NKG7","CCL5","GZMA","GZMB","GZMH","GZMK","CST7","CTSW","CD8A","PRF1","CD8B","LAG3","HCST","CCL4","AC092580.4","APOBEC3G","ALOX5AP","RARRES3","TUBA4A","CD52","STMN1","HMGB2","HIST1H4C","TUBA1B","KIAA0101","TUBB","HMGN2","TYMS","UBE2C","HMGB1","CORO1A","PTTG1","H2AFZ","PCNA","CXCL13","TK1","RRM2","DUT","NUSAP1","H2AFV","CKS1B","MKI67","BIRC5","PFN1","COTL1","TOP2A","ANP32B","ACTB","CDK1"] 

cluster1: CD4+T
cluster2: CD8+T NK-T/CTL?
cluster8: CD8+T cell cycle










========================================
|-- -- CD4+ T cell: rest vs activated
----------------------------------------

1.名词解释: 
> effector memory T cells re-expressing CD45RA (TEMRA)

> CD69 is one of the earliest cell surface markers seen at the surface of activated immune cells,

> Multiplex quantitative real-time polymerase chain reaction (RT-qPCR) using four TaqMan probes was used to evaluate 
    type I IFN-stimulated genes (IFI44 and MX1), 
    one type II IFN-stimulated gene (IRF1), 
    and one internal control gene (HRPT1), 


> CD62L(SELL) 
    - 中央记忆 (CM) T 细胞具有通常由初始T细胞表达的 LN 归巢受体，特别是 CD62L，也称为 L-选择素，一种聚糖受体
    - 效应记忆 (EM) T 细胞缺乏CD62L
    - T EMRA 细胞，包括重新获得初始表型的效应记忆 T 细胞（人类 CD45RA +，小鼠 CD44 int/low）



We identified 11 T cell subsets and annotated them according to their specific expressed genes (Figures 1D and 1E). 

(1). Rest
There are 6 T cell subsets mainly from resting CD4 T cells, namely 
TN (CCR7hi, SELLhi),  
TCM (CCR7+, SELL+, ANXA1+), 
TEM (CCR7low, ANXA1+, TIMP1+ ), 
CD4 TEMRA (ANXA1+ , CST7+ , GZMK+ , GZMA+ ), 
Treg (FOXP3+ , CTLA4+), 
and IFN signaling-associated gene (ISAG) highly expressed T cells (ISAGhi T) (ISG15hi, CCR7+ , SELL+ ) (Figures 1D, 1E, S1C, and S1D).




(2).activated
The other four T cell subsets mainly from stimulated CD4 T cells belong to CD4 TEFF (IL2RA+, IL2+, NME1+, MIR155HG+, and FABP5+) (Figures 1D and 1E). 

We further found that each of the four TEFF subsets has special features and called them 
conventional TEFF (conv TEFF), 
cytokines high TEFF (cytohi) TEFF, 
proliferation TEFF (prolif TEFF), 
and CTLA4hi TEFF (Figures 1D, 1F, S1E, and S1F).






2. 有效区分小鼠中9个T细胞亚群的9色流式方案
https://mp.weixin.qq.com/s?__biz=MjM5MTU2Njg4MA==&mid=2651821536&idx=1&sn=139a608d43a709e747b5a4998226e271

2021年10月19日，意大利国家研究委员会（CNR）分子生物学和病理学研究所的安布拉·纳塔利尼等人在Cytometry A上发表了一篇文章，设计并优化了一个比较简单的9色流式方案，能有效区分小鼠中9个T细胞亚群：

•Treg（CD3 + CD4 + CD8 - FoxP3 + ）
•CD4+naïve T（CD3 + CD4 + CD8 - FoxP3 - CD44 int/low CD62L + )
•CD4+中央记忆T（CD3 + CD4 + CD8 - FoxP3 - CD44 high CD62L + ）
•CD4+效应记忆T (CD3 + CD4 + CD8 - FoxP3 - CD44 高 CD62L - )
•CD4+T EMRA (CD3 + CD4 + CD8 - FoxP3 - CD44 int/low CD62L - )
•CD8+naïve T(CD3 + CD8 + CD4 - CD44 int/low CD62L + )
•CD8+中央记忆T (CD3 + CD8 + CD4 - CD44 high CD62L + )
•CD8+效应记忆T（CD3 + CD8 + CD4 - CD44 high CD62L - ）
•CD8+T EMRA（CD3 + CD8 + CD4 - CD44 int/low CD62L - ）









3. CD4+CTL分化发育的关键调控因子
https://mp.weixin.qq.com/s?__biz=MzA3MTg1OTM3MQ==&mid=2649978332&idx=2&sn=5ecc7319636f3a41bd21ed5e8e17bf11


(1) CD4+CTL与传统的CD4+ T细胞的区别在于它们杀伤靶细胞的能力，补充CD8+ T细胞的细胞毒性功能。现在的研究已经证实CD4+T细胞参与了抗肿瘤和抗感染免疫，是保护性免疫的重要力量，同时也与自身免疫性疾病发生密切相关，是治疗策略开发的重要靶点。

fig: Cytotoxic CD4+ T cell
	GZM, PRF1, GNLY, IFNG?

(2) CD4+CTL分化

初始CD4+ T细胞进入淋巴结（LN），并与同源抗原结合后被激活。

在这些激活之后，幼稚细胞要么分化为效应Th细胞，可以直接迁移到炎症部位，要么分化为中枢记忆Th细胞，可以在重复感染后迅速扩增。在LN中重新激活后，中枢记忆Th细胞也可分化为效应Th细胞，并向炎症组织迁移。

在炎症部位，效应CD4+ Th细胞被抗原提呈细胞（APC）重新激活（Re-activation），产生效应分子。

浸润的CD4+ T细胞也可以通过其他被激活的局部免疫细胞产生的细胞因子被非特异性地激活，这一过程被称为旁观者激活。

当炎症持续的状态下，记忆Th细胞会多次被重新激活，最终向CD4+CTL的分化。在获得细胞毒性潜能后，CD4 CTL要么仍然存在于局部组织中，要么重新进入循环。



(3) 转录因子: ThPOK-RUNX3回路

RUNX3 -> CD8 CTL
ThPOK -> CD4 CTL
	ThPOK(由 Zbtb7b 编码)

ThPOK和RUNX3是控制CD4和CD8细胞命运和CTL效应程序的关键转录因子。

CD4+辅助性T细胞和CD8+细胞毒性T细胞是在胸腺中由同时表达CD4和CD8的共同祖细胞产生的。 这些双阳性（DP）胸腺细胞发育成CD4单阳性（SP）细胞和CD8 SP细胞，其过程受到两个关键TFs的相互表达的严格调控，即ThPOK（T-helperinducing POZ/Krüppel-like factor）和RUNX3（Runt-related transcription factor 3）。

ThPOK是CD4+辅助细胞系发育的关键转录因子，在CD4+ T细胞中表达，但在CD8+T细胞中不表达，ThPOK功能的丧失导致MHCII类限制性CD8 SP胸腺细胞和外周CD8+ T细胞的出现，而ThPOK的强制表达导致MHCI类限制性细胞转向CD4谱系。

RUNX3是CD8谱系生成的关键TF。RUNX3与核心结合因子亚基（CBFβ）形成异二聚体复合体（RUNX3/CBFβ），RUNX3/CBFβ沉默CD8 SP胸腺细胞和CD8+ T细胞中CD4基因的表达，并通过与ThPOK沉默器结合，抑制接受了MHCI类信号的DP胸腺细胞中的ThPOK。

综上所述，ThPOK负调控Th细胞中RUNX3的表达，而RUNX3抑制CD8系T细胞中ThPOK的上调。ThPOK和RUNX3表达模式决定了CD4+ T细胞是否向CD4 CTL谱系分化的前提。



(4) 更多关键基因

1) T-bet
T-bet是Th1细胞的主调控因子，对CD8+T细胞中IFNγ、颗粒酶B和穿孔素的表达具有重要作用。关于CD4 CTL的生成，在流感感染模型中，T-bet缺失导致CD4+T细胞中颗粒酶B的表达受损，这表明T-bet在CD4+CTL的生成中可能也发挥了重要作用。

2) EOMES
与T-bet类似，EOMES在CD8+ T细胞中获得细胞毒性功能也至关重要，研究证明了EOMES在诱导CD4+的细胞溶解特征中发挥的作用。在CD4+CTL中诱导EOMES表达的信号通路为CRTAM（见下文）和共刺激分子OX40（CD134）和4-1BB（CD137），以及Foxo3。

3) Blimp-1
Blimp-1是另一种显示有助于CD4+CTL分化的转录因子。据报道，Blimp-1促进T-bet与细胞毒性相关基因启动子的结合能力，并诱导细胞溶解潜能。相应地，单细胞转录组分析发现，细胞毒性CD4+T细胞中高水平的Blimp-1表达。

4) STAT
其他参与CD4 CTL分化调控的转录因子还有STAT家族的成员。一些研究也表明，IL-2和一个STAT2依赖的I型干扰素信号通路通过诱导T-bet和Blimp-1的上调，对CD4+CTL的分化具有重要作用。在没有STAT2的情况下，T-bet和颗粒酶B的表达减少。HDAC1和HDAC2的缺失可以诱导CD4+ T细胞中的CTL程序，依赖于IFNγ-JAK1/2-STAT1信号通路，因为JAK1/2的抑制部分阻断了CD4 CTL的分化。









========================================
|-- 先天性淋巴细胞（Innate lymphoid cell, ILC）: NK, ILC2, ILC3
----------------------------------------
1. mouse atlas2
> b1=FindMarkers(atlas2, ident.1 = "NK cell")

["Bcl2","Rgs1","Xcl1","Dusp2","Sh2d2a","S100a10","Cd2","Ugcg","Lck","Txk","Vps37b","Gimap4","Gimap5","Klrb1a","Klrb1c","Klre1","Klrd1","Klrk1","Klrc2","Klri2","Klra4","Klra8","Klra9","Klra7","Klra3","Ncr1","Nkg7","Ifngr1","Prf1","Ifng","Gzmb","Eomes","Ccl5","Ccl3","Ccl4","Cd7","Serpinb6b","Serpinb9","Ctla2a","Gzma","Id2","Il2rb","Lgals1","Sytl3","H2-K1","H2-Q7","Ctsw","Ahnak","AW112010","Ms4a4b"] 













========================================
髓系发育路径：mono, macrophage, DC
----------------------------------------
Cell：张泽民研究组揭示结直肠癌靶向髓系细胞的免疫治疗机理 2020
https://baijiahao.baidu.com/s?id=1664423924575081741&wfr=spider&for=pc





========================================
|-- monocyte 单核细胞
----------------------------------------
1. mouse atlas2
b1=FindMarkers(atlas2, ident.1 = "Monocyte")
# b1= FindAllMarkers(atlas2, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)

["Fn1","Dbi","Vim","Zeb2","Cst3","Mafb","Ctsz","Psma7","Anxa5","S100a4","Ctss","Klf4","Prdx1","Sdc3","Plac8","Rassf4","Clec4a1","Clec4a3","Apoe","Ctsc","Ifitm3","Smpdl3a","Psap","Lyz2","Lrp1","Lamp1","Hpgd","Lpl","Hmox1","Lgals3","Ctsb","Trf","Ccr2","Cd68","Ccl9","Gngt2","Grn","F13a1","Npc2","Lgmn","Pld4","Crip1","Selenop","Lgals1","Aif1","Csf1r","Ahnak","Ms4a4c","Ms4a6c","Mpeg1"] 










========================================
|-- macrophage marker 巨噬细胞: M1 促炎-抗肿瘤, M2 抑炎-促肿瘤
----------------------------------------
1. 2021, Mol Ther Nucleic Acids, IF=7.032
(单基因免疫相关分析发7分+2区SCI)
ncRNAs-mediated high expression of SEMA3F correlates with poor prognosis and tumor immune infiltration of hepatocellular carcinoma
研究SEMA3F在多种癌症中的表达水平和与预后的作用。并研究SEMA3F与免疫细胞浸润和免疫检查点表达的相关性。

B细胞标志物（CD19和CD79A）、
CD8+ T细胞标志物（CD8A和CD8B）、
CD4+ T细胞标志物（CD4）、
M1巨噬细胞标志物（NOS2、IRF5和PTGS2）、
M2巨噬细胞标志物（CD163、VSIG4和MS4A4A）、
中性粒细胞标志物（CEACAM8, ITGAM和CCR7）
和树突状细胞标志物（HLA-DPB1, HLA-DQB1, HLA-DRA, HLA-DPA1, CD1C, NRP1 和 ITGAX )



2. HNSCC 
# cluster 4
["C1QB","LYZ","C1QA","C1QC","IL1B","TYROBP","CCL3","APOE","FCER1G","CXCL8","G0S2","APOC1","AIF1","CCL3L3","SPP1","HLA-DRA","CXCL3","CCL18","PLAUR","HLA-DPA1","FTL","HLA-DRB1","HLA-DPB1","CD14","HLA-DRB5","CD68","C15orf48","CD74","CTSB","MS4A6A","LST1","CCL4L2","HLA-DQB1","SOD2","MMP12","HLA-DQA1","EREG","TIMP1","CTSD","MMP9","CXCL2","SPI1","PSAP","BCL2A1","CTSZ","CTSS","MS4A7","CCL4","FTH1","SERPINA1","GRN","RNASE1","IL1RN","CTSL","GPX1","LGALS2","RP11-1143G9.4","HLA-DMB","HLA-DQA2","FCGR2A","SAT1","HLA-DMA","CCL20","LGMN","FCGR3A","NPC2","CST3","ACP5","FAM26F","CAPG"]









========================================
|-- DC marker 树突细胞
----------------------------------------
1. in mouse

CD11c (Dendritic Cell Marker) (ITGAX/1284),

(1)
1) wangXuefei-2021.11
"Ccl22","Ccr7","Fscn1","Ccl5","Tnfrsf9","Sema7a","Stat4","Il12b",#cDC1
"Xcr1","Cd207","Clec9a","Batf3","Cadm1","Cd36","Itgae","Cd24a",
"Itgax","Ly6i","H2-DMb1","Cd209a","Lilrb4a","H2-DMb2","Csf1r",#cDC2
"Siglech","Ccr9","Tcf4","Ctsl","Bst2","Bcl11a","Runx2",#pDC

DotPlot(scObj, features =
list(
	cDC1=c("Ccl22","Ccr7","Fscn1","Ccl5","Tnfrsf9","Sema7a","Stat4","Il12b"),
	cDC2=c("Xcr1","Cd207","Clec9a","Batf3","Cadm1","Cd36","Itgae","Cd24a",
		   "Itgax","Ly6i","H2-DMb1","Cd209a","Lilrb4a","H2-DMb2","Csf1r"),
	pDc=c("Siglech","Ccr9","Tcf4","Ctsl","Bst2","Bcl11a","Runx2")
  )
)+RotatedAxis()


2). mouse BM atlas2
> b1 = FindMarkers(atlas2, ident.1 = "Dendritic cell") # 貌似不太靠谱
["Rpl31","Ramp1","Ppfia4","Atp1b1","Tagln2","Kmo","Bmyc","Snx5","Rpl10","Plac8","Gltp","Ptms","Lair1","Klk1","Siglech","Nucb2","Cox6a2","Ccnd1","Psap","Upb1","Cd209d","Bst2","Mvb12a","Pgls","Irf8","Rnase6","Ctsb","Tsc22d1","Ctsh","Ccr9","Bcl11a","Rnf187","Dnajc7","Grn","Cd300c","Smim5","Syngr2","Cd7","Ly86","H2afy","Ctsl","Gm21762","Pld4","Dap","Ly6d","Lgals1","AC140186.1","Runx2","Tcf4","Dntt"] 
















========================================
粒细胞(Granulocytes)发育路径：中性粒细胞，嗜酸性粒细胞，嗜碱性粒细胞，肥大细胞
----------------------------------------




========================================
|-- Neutrophil marker 中性粒细胞
----------------------------------------

//Yue wenjun
c("S100a9", "S100a8", "Retnlg", "Ngp", "Lcn2", "Lyz2", "Mmp8", "Ltf", "Wfdc21", "Ifitm6", "Camp", "Mmp9", "Pglyrp1", "Chil3", "Cd177", "Fpr2", "Cxcr2", "Slpi", "Anxa1", "Lrg1", "Alox5ap", "Gda", "Mcemp1", "Cybb", "Slfn4", "Ckap4", "Il1f9", "S100a6", "Clec4e", "Cd24a", "Actn1", "Cd33", "S100a11", "Msrb1", "C5ar1", "Ly6c2")



1. in atlas2 

> wjl4=FindMarkers(atlas2, ident.1 = "Neutrophil")
> wjl4.markers = wjl4 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
    top_n(n = 50, wt = avg_log2FC)
> DotPlot(atlas2, features = rownames(wjl4.markers) )+RotatedAxis()

> rownames(wjl4.markers) |> jsonlite::toJSON()
["Rnf149","Il1r2","Cxcr2","G0s2","Lcn2","Hdc","Il1b","Slpi","Mmp9","Slc7a11","S100a6","S100a8","S100a9","S100a11","Chil3","Csf3r","Fbxl5","Cxcl2","Asprv1","Mxd1","Clec4d","C5ar1","Pglyrp1","Ifitm2","Ifitm1","Ifitm6","Srgn","Mcemp1","Gsr","Hp","Mmp8","Camp","Ngp","Ltf","Ccr1","Slfn1","Ccl6","Wfdc17","Wfdc21","Pygl","Ly6g","Grina","Stfa2l1","Gm5483","Retnlg","Msrb1","H2-Q10","Lrg1","Anxa1","Gda"]









========================================
|-- basophil [ˈbeɪsəfɪl] n. 嗜碱性粒细胞
----------------------------------------
https://www.rndsystems.com/cn/resources/cell-markers/immune-cells/granulocytes/basophil-cell-markers

1. for mouse in Bone marrow

> wjl3=FindMarkers(atlas2, ident.1 = "Basophil")
> wjl3.markers = wjl3 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
    top_n(n = 50, wt = avg_log2FC)
> DotPlot(atlas2, features = rownames(wjl3.markers) )+RotatedAxis()

> rownames(wjl3.markers) |> jsonlite::toJSON()
["Il18r1","Rgs1","Mpc2","Fcer1a","Hdc","Cpa3","S100a10","Csf1","Gm12840","Padi2","Hgf","Il6","Tec","Plac8","Lat2","Gata2","Ptms","Cebpa","Csrp3","Ifitm1","Lilr4b","Cd63","Cdh1","Slc7a8","Mcpt8","Tbc1d4","Gpr183","Cyp11a1","Nedd4","Osm","Ccl9","Ccl3","Ccl4","Itga2b","Csf2rb2","Csf2rb","Cd200r3","Runx1","Sytl3","Prss34","Rab44","Ier3","Emilin2","Ms4a2","Stx3","Jak2","Ctsg","Ccl6","Jun","Hsph1"]

// 怀疑这是否注释错了！这是 嗜碱性粒细胞 还是 肥大细胞？ //todo



> DotPlot(atlas2, features = c(
     wjl3 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
         top_n(n = 50, wt = avg_log2FC) %>% arrange(-pct.1) %>% rownames()
 ) )+RotatedAxis()
> 










========================================
|-- mast cell 肥大细胞，特点是 IgE FC 受体(Fcer1g) //todo
----------------------------------------
https://www.rndsystems.com/cn/resources/cell-markers/immune-cells/granulocytes/mast-cell-markers

1.
目前认为，肥大细胞驱动的过敏反应。主要是抗原诱导肥大细胞表面FceRI受体分子的聚集，引发肥大细胞释放炎症介质的结果。肥大细胞均含有特定的胞质颗粒，其中贮存有炎症介质。介质释放到胞外区称为脱颗粒(degranulation)。

Fcer1g
Fcer1a

mast=c("Fcer1a", "Itgb7", "Fcer1g", "Cpa3","Mcpt8", "Csf1"),


2.不同
(1) 位置不同 
嗜碱性粒细胞存在于血液中，是白细胞的一种，占血液白细胞总数的0-0.5％，而肥大细胞主要存在于外周组织中，可以存在于呼吸道、消化道、末梢神经等周围组织。

(2) 释放物质不同
肥大细胞活化过程中产生前列腺素PGE2和PGD2,使小血管扩张,通透性增高，对疼痛敏感,PGD2还引起支气管收缩,抑制血小板聚集，促进嗜碱性粒细胞释放组胺。阿斯匹林可影响前列腺素的代谢。
Ptger2
Ptgds

Cr1l









========================================
*** 红细胞（red blood cell, RBC; erythrocyte, ERY）CD45-； 造血干细胞 Hematopoietic stem cell(HSC) 分化路径 ***
----------------------------------------
Hematopoietic / ,hemətəʊpɒɪ'i:tɪk / adj.造血的；生血的
erythrocyte / ɪˈrɪθrəsaɪt / n. [细胞] 红细胞；[细胞] 红血球


红细胞和血小板中不含CD45。


HSC, MPP, 
pro-祖细胞：
    burst forming unit-erythroid: BFU-E
    colony forming unit-erythroid: CFU-E
pre-前体细胞：
    到前体细胞，可以有形态差异了：原始 红细胞，早幼红细胞，中幼红细胞，晚幼红细胞
网织红细胞：
    晚幼红细胞不再具备分裂能力，脱核后形成网织红细胞释放入血，进一步生成成熟红细胞。
    脱核在晚幼红细胞阶段发生,晚幼红细胞刚脱核的分化阶段成为网织红细胞,其胞质内仍含嗜碱物质,属未成熟红细胞。
    成熟红细胞由网织红细胞进一步发育而来

血小板 是 巨红核细胞碎片。


> table(atlas2$majorCellType)
   HSC            MPP     Neutrophil       Monocyte Dendritic cell       Basophil 
   203            376          53750          12594           4311            995 
T cell        NK cell         B cell  Megakaryocyte    Erythrocyte 
 11394           2817          17957            364           1316 


> b1=FindMarkers(atlas2, ident.1 = "HSC")
> b1.markers = b1 %>% filter(p_val_adj<0.05 & (pct.1>0.2 | pct.2>0.2)) %>% 
    top_n(n = 50, wt = avg_log2FC);

DotPlot(atlas2, features = rownames(b1.markers) )+RotatedAxis();
rownames(b1.markers) |> jsonlite::toJSON()



========================================
|-- HSC -> MPP
----------------------------------------
1. for mouse in Bone marrow
(1) HSC 
["Cd34","Egfl7","Procr","Car2","Adgrl4","Pdzk1ip1","Gm19590","Gng11","Tmem176b","Gata2","Rab38","Tspan4","Myct1","Adgrg1","Tsc22d1","Nrgn","Meis1","Hlf","Angpt1","Krt18","Muc13","Ctla2a","Tmem176a","Serpina3g","Mllt3","Lmo2","Sox4","Kit","Rgs1","Glul","Gstm1","Msi2","Pebp1","Nr4a1","Rpl3","Rpl10a","Rps4x","Ramp1","Rps14","Rpl36a","Eef1a1","Dusp2","Rpl21","Rpl32","Rpl14","Rps18","Rps6","Rpl22l1","Ccl4","Jun"] 

(2) MPP
["Rgs1","Cd34","Lmo2","Car2","Adgrl4","Cdk6","Tmem176b","Rab38","Myct1","Adgrg1","Tsc22d1","Igfbp4","Sox4","Ctla2a","Serpina3g","Prtn3","Myb","Stmn1","Pebp1","Ccl4","Ramp1","H2afy","Hnrnpa1","Cmtm7","Rpl3","Npm1","Rpl10a","Rpl15","Rpl32","Rps2","Ccl9","Eef1g","Nr4a1","Rps4x","Rps17","Rpl36a","Eef1a1","Rpl14","Rps18","Rpl22l1","Rps5","Ncl","Rplp0","Rps19","Rps6","Rpl36","Rpl35","Ccl3","Jun","Hspd1"] 


(3) 互相比较
HSC vs. MPP
["Pdzk1ip1","Sult1a1","Procr","Hlf","Mllt3","Txnip","Hacd4","Mpl","Ifitm3","Tgm2","mt-Co1","Nkx2-3","Npdc1","Trim47","Car2","Mecom","Gda","Ltb","Mmrn1","Nupr1","Glul","Cavin2","Ly6a","Adgrg1","Clec1a","Aldh1a1","Itsn1","Zbtb20","Meis1","Gng11","Tsc22d1","Iigp1","Tbxas1","Alcam","Shisa5","Ldhb","H2-Q6","Eif4a2","Zfp36l2","Zfp467","Aplp2","Uba7","Nceh1","Cited2","Egr1","S100a6","Gcnt2","Mycn","mt-Nd4","Pbx1"]

MPP vs. HSC 
["Plac8","Ptma","H2afy","Eif4a1","Ran","Mpo","Nkg7","Cd48","H2afz","Stmn1","Slc25a5","Cdk6","Dynll1","Igfbp4","Ctsg","Ybx1","Cks2","Mcm6","BC035044","S100a10","Hspa8","Adgrg3","Tmsb10","Hdgf","Dtymk","Anp32b","Cebpa","Ccl9","Nme1","Ranbp1","Nhp2","Srm","Mif","Apex1","Phgdh","Cpa3","Lat2","Ncl","Dut","Ap3s1","Lgals1","Ppp1r14b","Sell","Hnrnpab","Cdca7","Hsp90aa1","Hspe1","Hspd1","Dnaja1","Hist1h2ap"]









========================================
|-- Megakaryocyte 巨核细胞: 成熟的巨核细胞边缘部分破裂脱落后形成血小板
----------------------------------------
1. mouse atlas2
(1) b1=FindMarkers(atlas2, ident.1 = "Megakaryocyte")
["Cavin2","Hmgb3","Car2","Dapp1","Cdk6","Pf4","H1fx","Ybx3","Adgrg1","Zfpm1","Nrgn","Nedd4","Meis1","Itga2b","Ctla2a","Angpt1","Muc13","Slc14a1","Dut","Stmn1","Lmo2","Top2a","Hist1h2ae","Kcnq1ot1","Hist1h1b","Mki67","Nucks1","Mef2c","Hdgf","Pebp1","Snrpd1","Atpif1","Rgs18","Etfb","Ran","Anp32b","Nap1l1","Npm1","Mif","Ncl","Serbp1","Pbx1","Set","Ppbp","Hspd1","Tuba1b","Hist1h2ap","Pdcd4","Tubb5","Hspe1"] 

(2) b1=FindMarkers(atlas2, ident.1 = "Megakaryocyte", ident.2="Erythrocyte")
["Mef2c","Serpina3g","Meis1","Ctla2a","Pbx1","Plek","Cavin2","Itga2b","Fli1","Cd9","Angpt1","Zyx","Nrgn","Tmsb4x","Sptbn1","Rgs18","Celf2","Cited2","Ptpn18","Bin2","Rab27b","Ifitm3","H1fx","Sh3bgrl3","Pkm","Adgrg1","Tagln2","H2afy","Pf4","Dapp1","Fxyd5","Gmfg","Actg1","Arpc1b","Rap1b","H2-K1","Arhgdib","Cmtm7","Rabgap1l","Vwf","Lyz2","Pdcd4","Ppbp","S100a8","S100a9","Ngp","Lcn2","Ltf","Wfdc21","Camp"] 





========================================
|-- Erythrocyte 红细胞 / 红血球
----------------------------------------
1. mouse atlas2
(1) b1=FindMarkers(atlas2, ident.1 = "Erythrocyte")
["Hspd1","Ncl","Ctse","Mgst3","Dut","Hmgb3","Car1","Car2","Hdgf","Hemgn","Anp32b","Alad","Ermap","Pabpc4","Atpif1","Rhd","C1qtnf12","Ran","Cldn13","Mcm7","Aqp1","Serbp1","Ybx3","Blvrb","Stard10","Rrm1","Hbb-bt","Hbb-bs","Mki67","Rps12","Metap2","Gypa","Klf1","Prdx2","Hmbs","Mns1","Hba-a1","Hba-a2","Npm1","Nme1","Atp5g1","Top2a","Slc4a1","Hist1h1b","Tmem14c","Dek","Glrx5","Tfrc","Cpox","Rps2"] 

(2) b1=FindMarkers(atlas2, ident.1 = "Erythrocyte", ident.2="Megakaryocyte")
["Blvrb","Prdx2","Tspo2","Ermap","Klf1","Car1","Rhd","Car2","Ctse","Glrx5","Cldn13","Gypa","Rhag","Tspan33","Slc38a5","Metap2","Ank1","Cpox","Cd24a","Hmbs","Nxpe2","Tfrc","Abcb4","Aqp1","Ces2g","C1qtnf12","Spta1","Alad","Hebp1","Fth1","Smim1","Minpp1","Isg20","Mns1","Fech","Ubac1","Hba-a1","Tmem14c","Mkrn1","Hbb-bt","Mgst3","Hba-a2","Hbb-bs","Hemgn","Snca","Rrm2","Slc25a37","Slc4a1","Mt1","Alas2"] 






========================================
Epithelial marker 上皮细胞
----------------------------------------
1.
"EPCAM", 'KRT8', 'KRT18', 'KRT19', 'KRT5', 'KRT15',


2.HNSCC

(1) main cluster 3
>  scObj.markers %>% group_by(cluster) %>%
     filter(cluster==3) %>%  #by cluster
     top_n(n = 70, wt = avg_log2FC) %>% arrange( desc(pct.1) ) %>%
     pull("gene") %>% jsonlite::toJSON()
["GSTP1","S100A11","HSPB1","PERP","CSTB","TACSTD2","CD9","FXYD3","SPINT2","KRT17","SFN","S100A2","IFI27","S100A16","SLC25A5","KRT5","S100A14","JUP","KRT6A","CSTA","HMGA1","DSP","SDC1","FABP5","S100A9","KRT18","S100A8","PITX1","NDRG1","CALML3","CD24","KRT16","LYPD3","CDKN2A","SLC2A1","KRT8","EFNA1","KRT14","KRT19","KRT15","MDK","CLDN4","ELF3","LY6D","MAL2","SLPI","IGFBP2","C19orf33","RBP1","ERO1A","LAMB3","GJB2","RHOV","KRT6B","KRT13","SPRR1B","CALML5","NDUFA4L2","CNFN","ALDH3A1","C15orf48","RHCG","SPRR2D","S100A7","KRT6C","SPRR2A","LCN2","PI3","SPRR2E","SPRR3"] 

(2) minor cluster 17 
["KRT19","MT-CO3","CD9","MT-CO1","MT-ND3","MT-ND1","WFDC2","SLPI","TACSTD2","FXYD3","KRT8","AQP3","KRT18","KRT17","CLDN4","TSC22D1","ELF3","AGR2","GSTA1","MGST1","MTRNR2L8","MTRNR2L12","ATF3","ATP1B1","ALDH3A1","ID1","CLU","PRSS23","LCN2","TSPAN1","C19orf33","RND3","KRT15","ETS2","PMAIP1","F3","KLF5","NCOA7","SDC4","AREG","CXCL17","GPX2","NUCB2","CLDN7","EPCAM","MUC4","KRT7","PLPP2","ADH7","AKR1C2","PIGR","AQP5","MUC1","GPRC5A","UPK1B","FAM3D","LMO7","MSLN","GDF15","DST","MUC16","S100P","NTS","VMO1","SERPINB3","TFF3","SCGB3A1","MSMB","PI3","SCGB1A1"] 





========================================
Endothelial cell markers 内皮细胞
----------------------------------------

1. paper:
(1).Cell. 2020 Feb 20;180(4):764-779.e20. doi: 10.1016/j.cell.2020.01.015. Epub 2020 Feb 13.
Single-Cell Transcriptome Atlas of Murine Endothelial Cells
https://pubmed.ncbi.nlm.nih.gov/32059779/

(2).Circulation. 2021 Jul 27; 144(4): 286–302.
Published online 2021 May 25. doi: 10.1161/CIRCULATIONAHA.120.052318
PMCID: PMC8300155 | PMID: 34030460
Integrated Single-Cell Atlas of Endothelial Cells of the Human Lung
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8300155/


CD31(Pecam1), eNOS(Nos3), VE-cadherin(Cdh5), vWF(Vwf), and CD146(Mcam)
	"Pecam1", "Nos3", "Cdh5", "Vwf", "Mcam", #Endothelial




2. HNSCC
(1) main cluster 6
> scObj.markers %>% group_by(cluster) %>%
    filter(cluster==6) %>%  #by cluster
    top_n(n = 70, wt = avg_log2FC) %>% arrange( desc(pct.1) ) %>%
    pull("gene") %>% jsonlite::toJSON()
["IFITM3","IFI27","GNG11","RAMP2","CRIP2","SPARCL1","RNASE1","FKBP1A","TM4SF1","ADIRF","PECAM1","CAV1","NPDC1","PTRF","ECSCR.1","IGFBP7","PDLIM1","A2M","BCAM","ID3","AQP1","CLEC14A","VWF","SOCS3","ENG","PCAT19","HSPG2","EGFL7","CLU","EPAS1","ID1","KLF2","RAMP3","ESAM","HES1","SLC9A3R2","JAM2","CLDN5","ADAM15","EMCN","PLVAP","ICAM1","GIMAP7","ADGRL4","DUSP23","PALMD","ACKR1","TSPAN7","HYAL2","PRCP","CD93","SNCG","CCL2","MMRN2","CXorf36","ICAM2","CDH5","KCTD12","ADAMTS1","FLT1","RGS16","IGF2","SDPR","PODXL","SELE","RND1","CCL14","C2CD4B","STC1","FABP4"] 

(2) small cluster 12

["VIM","IGFBP7","GNG11","IFITM3","ECSCR.1","CD59","CD9","TFPI","TFF3","TIMP1","CLDN5","RAMP2","ADIRF","TM4SF1","CCL21","CYB5R3","CRIP2","GYPC","CD151","RAB11A","GNAS","EFEMP1","CAV1","EGFL7","APP","MMRN1","SDPR","PPFIBP1","PDLIM1","CLU","S100A16","MARCKSL1","ARL4A","CNN3","ARHGAP29","PECAM1","MGST2","DKK3","LIMS1","SNCG","HYAL2","PTPRE","HES1","PCAT19","SLC9A3R2","FAM213A","RGS16","ID1","PROX1","LYVE1","GIMAP7","AKAP12","NRP2","TIE1","C16orf62","KANK3","PDPN","FXYD6","RHOJ","PLSCR4","CCL2","CXorf36","EDNRB","ANGPT2","TM4SF18","TPPP3","FABP4","RAMP3","NTS","EDN1"]

(3) 交集
["IFITM3","GNG11","RAMP2","CRIP2","TM4SF1","ADIRF","PECAM1","CAV1","ECSCR.1","IGFBP7","PDLIM1","PCAT19","EGFL7","CLU","ID1","RAMP3","HES1","SLC9A3R2","CLDN5","GIMAP7","HYAL2","SNCG","CCL2","CXorf36","RGS16","SDPR","FABP4"] 




ref:
https://www.abcam.com/primary-antibodies/endothelial-cell-markers








========================================
Fibroblast marker 成纤维细胞
----------------------------------------
1.
"Col1a2", "Col3a1", "Fbln2", "Fstl1", "Gsn", "Mmp2", "Sparc", "Vim",


2. HNSCC
(1) main cluster 0
> scObj.markers %>% group_by(cluster) %>%
    filter(cluster==0) %>%  #by cluster
    top_n(n = 70, wt = avg_log2FC) %>% arrange( desc(pct.1) ) %>%
    pull("gene") %>% jsonlite::toJSON()

["DCN","LGALS1","COL1A2","C1S","SERPING1","COL6A2","C1R","GSN","LUM","SERPINF1","FBLN1","COL6A1","MFAP4","PLAC9","S100A13","CCDC80","COL1A1","FBLN2","SOD3","IGFBP6","PCOLCE","EGR1","COL3A1","PMP22","MGP","MMP2","FSTL1","MXRA8","TIMP3","LTBP4","CFD","SPARC","COL6A3","MEG3","DPT","SDC2","FN1","IGFBP4","ISLR","EFEMP1","CYR61","APOD","PLPP3","NNMT","CTSK","RARRES2","CTGF","FBN1","IGFBP5","CXCL12","PDGFRL","MFAP5","GPX3","C3","HTRA3","BGN","TNXB","TPPP3","CXCL14","SFRP2","THBS4","PI16","PLA2G2A","SMOC2","ADH1B","PCOLCE2","PTGDS","SFRP4","PRG4","MYOC"] 

(2) minor cluster 11
? 可能不是




========================================
肌细胞 Myocyte
----------------------------------------

1. HNSCC
(1) main cluster 15

["ACTA1","TNNC2","CKM","MYL1","MYLPF","DES","ENO3","TNNT3","TCAP","MB","TNNI2","COX6A2","TPM2","SLN","MYOZ1","PGAM2","S100A1","ATP2A1","KLHL41","CRYAB","COX7A1","PYGM","CA3","CSRP3","MYH2","PDLIM3","MYBPC1","SMPX","MYBPC2","PDE4DIP","STAC3","GAMT","FHL3","NEB","ACTN2","C8orf22","TTN","MYOT","LDB3","CMYA5","RP11-451G4.2","RPL3L","APOBEC2","PPP1R27","ADSSL1","HSPB7","TCEA3","CALML6","NRAP","FABP3","FITM1","SLC25A4","AK1","TNNC1","FHL1","HSPB6","BIN1","CFL2","FXYD1","PGM1","TPM1","NDRG2","PDLIM5","ALDOA","GAPDH","YBX3","CHCHD10","SEPW1","LINC00116","MYL6B"] 





























========================================
细胞类型 自动注释: singleR
----------------------------------------

Using SingleR to annotate single-cell RNA-seq data
https://www.bioconductor.org/packages/release/bioc/vignettes/SingleR/inst/doc/SingleR.html


1. 安装

> BiocManager::install("SingleR")
Bioconductor version 3.13 (BiocManager 1.30.16), R 4.1.0 (2021-05-18)
Installing package(s) 'SingleR'
also installing the dependencies ‘sparseMatrixStats’, ‘RcppHNSW’, ‘ScaledMatrix’, ‘rsvd’, ‘DelayedMatrixStats’, ‘BiocNeighbors’, ‘BiocSingular’, ‘beachmat’


> library(SingleR)
Loading required package: SummarizedExperiment
Loading required package: MatrixGenerics
Loading required package: matrixStats
...

(2) 解决报错

1) mouseImmu <- ImmGenData()
Error in loadNamespace(x) : there is no package called ‘celldex’
In addition: Warning message:
'ImmGenData' is deprecated.
Use 'celldex::ImmGenData' instead.
See help("Deprecated")

安装该包: BiocManager::install("celldex") #version 1.2.0  Reference Index for Cell Types

# 探索一下该包
> table(mouseImmu$label.main) # 各种细胞类型
> table(mouseImmu$label.fine) # 精细细胞类型

> mouseImmu
class: SummarizedExperiment
dim: 22134 830
metadata(0):
assays(1): logcounts
rownames(22134): Zglp1 Vmn2r65 ... Tiparp Kdm1a
rowData names(0):
colnames(830): GSM1136119_EA07068_260297_MOGENE-1_0-ST-V1_MF.11C-11B+.LU_1.CEL
  GSM1136120_EA07068_260298_MOGENE-1_0-ST-V1_MF.11C-11B+.LU_2.CEL ...
  GSM920654_EA07068_201214_MOGENE-1_0-ST-V1_TGD.VG4+24ALO.E17.TH_1.CEL
  GSM920655_EA07068_201215_MOGENE-1_0-ST-V1_TGD.VG4+24ALO.E17.TH_2.CEL
colData names(3): label.main label.fine label.ont



> mouseRNA <- MouseRNAseqData() #等待下载，然后载入
> mouseRNA
class: SummarizedExperiment
dim: 21214 358
metadata(0):
assays(1): logcounts
rownames(21214): Xkr4 Rp1 ... LOC100039574 LOC100039753
rowData names(0):
colnames(358): ERR525589Aligned ERR525592Aligned ... SRR1044043Aligned SRR1044044Aligned
colData names(3): label.main label.fine label.ont









2. 使用

library(SingleR)

#这是测试，为了快，先取个子集
table(scObj_known2$seurat_clusters)
sce=subset(scObj_known2, downsample=200)
sce #6.4k cells

# 获取数据
sce_for_SingleR <- GetAssayData(sce, slot="data")
clusters=sce@meta.data$seurat_clusters

# 获取免疫参考数据
mouseImmu <- ImmGenData() #需要 celldex 包
#/home/wangjl2/.cache/R/ExperimentHub
# does not exist, create directory? (yes/no): yes
pred.mouseImmu <- SingleR(test = sce_for_SingleR, ref = mouseImmu, labels = mouseImmu$label.main,
                          #method = "cluster",
                          clusters = clusters,
                          assay.type.test = "logcounts", assay.type.ref = "logcounts")

# 获取小鼠参考数据
mouseRNA <- MouseRNAseqData() #等待下载，然后载入
pred.mouseRNA <- SingleR(test = sce_for_SingleR, ref = mouseRNA, labels = mouseRNA$label.fine ,
                         #method = "cluster",
                         clusters = clusters,
                         assay.type.test = "logcounts", assay.type.ref = "logcounts")


# 两者综合
cellType=data.frame(ClusterID=levels(sce@meta.data$seurat_clusters),
                    mouseImmu=pred.mouseImmu$labels,
                    mouseRNA=pred.mouseRNA$labels )
head(cellType)
dim(cellType)
# 添加上注释
sce@meta.data$singleR=cellType[match(clusters,cellType$ClusterID),'mouseRNA']



pro='first_anno'
DimPlot(sce,reduction = "umap",label=T, group.by = 'singleR')+scale_color_manual(values=allcolour)
# ggplot2::ggsave(filename = paste0(pro,'_tSNE_singleR.pdf'))
DimPlot(sce,reduction = "umap",label=F,split.by ='orig.ident',group.by = 'singleR', ncol=4)&scale_color_manual(values=allcolour)
# ggplot2::ggsave(filename = paste0(pro,'_tSNE_singleR_by_orig.ident.pdf'))

#save(sce,file = 'last_sce.Rdata')
# saveRDS(sce,file = 'sce_v0.1_.Rdata')



















========================================
My data
----------------------------------------

1. neutrophil cells from FACS: Cd11b+Ly6d

(1)趋化因子 Chemokine
趋化因子被分为四个主要亚家族：CXC、CC、CX3C和XC

1)Cxcr1,2,3,4,5,6
	Cxcr3,6: T cell;
	Cxcr5: B

C-X-C/α亚族，主要趋化中性粒细胞



2) 趋化因子CXC配体9
Cxcl1,2,3, 5,  9,10, 12,13,14,15,16
	Cxcl3: Nue?(11)
	Cxcl2: Nue?(11,25)
	Cxcl9: Nue?(25)
	Cxcl10: Nue?(25, 11)
	Cxcl13: Macrophage
	Cxcl16: Macrophage, Nue?(25)

3) Ccl 系列
	macrophage: Ccl2,7,8, 12,
	Ccl24: macrophage
	Ccl5: NK
	mast cell: Ccl3,4,6,9,


4) 趋化因子受体 Ccr1,2,3,4,5,6,7,8,9,10
趋化因子受体(Cxc Chemokine Receptor 7)
	Ccr6: B
	Ccr7: B
	Ccr10: plasma
	Ccr2: Mono?(22),

	Ccrl2: Nue?(11,25),
	Ccr1: Nue?(27),

5) Cx3
	Cxc3cr1: plasma;
6) Xc
	Xcl1: NK, T;
	Xcr1: cDC;



(2) cytokines 细胞因子
由免疫细胞（如单核、巨噬细胞、T细胞、B细胞、NK细胞等）和某些非免疫细胞（内皮细胞、表皮细胞、纤维母细胞等）经刺激而合成、分泌的一类具有广泛生物学活性的小分子蛋白质。

细胞因子可被分为白细胞介素、干扰素、肿瘤坏死因子超家族、集落刺激因子、趋化因子、生长因子等。



1) 白介素 Il*
	Il7r: T, mast cell;
	Il6: mast cell;
	Il2ra: T;

2) 集落刺激因子（colony stimulating factor, CSF)
	Csf1: mast cell;

3) 干扰素（interferon, IFN)
	Ifng: T, NK,
	Ifngr1: T, NK,cDC, Mono?(22),


4) 肿瘤坏死因子（tumor necrosis factor, TNF)
	T: Tnfrsf18, 9,4;
	Tnfrsf17: plasma;
	Tnf: Nue?(11,25)

5) 转化生长因子-β家族（transforming growth factor-β family, TGF-β family)
	Tgfbr2: macrophage;

6) 生长因子（growth factor,GF）


7) 趋化因子家族（chemokine family)




(2) 颗粒酶 Gzm*
	NK: Gzma,b




(3) Siglec*
	Siglecg: B, cDC
	Siglech: pDC,
	Siglece:



(4) Ly6*
	Ly6d: pDC, plasma;
	Ly6i: cDC?/mono?


(5) Clec*
	Clec9a: cDC
	Clec1b: Platelet(Ppbp)
	Clec4d: nue?(11,27)

(6) Ccn*
	Ccne2: 29,
	Ccnb2: 29,






========================================
color sets
----------------------------------------
1. 张泽民 Science 2021,
# CD8+ meta cluster:
colors.CD8=c("#96C3D8", "#5F9BBE", "#F5B375", "#C0937E", "#67A59B", "#A5D38F", "#4A9D47", "#F19294", "#E45D61", "#3377A9", "#BDA7CB", "#684797", "#8D75AF", "#CD9C9B", "#D62E2D", "#DA8F6F", "#F47D2F")
barplot(rep(1,length(colors.CD8)), col=colors.CD8, border = NA, space=0, axes=F)


# CD4+ meta cluster:
colors.CD4=c("#79AECB","#4C8DA1","#84BC95","#70B866","#AB9697","#EC8D63","#CFC397","#F5A666","#4588B4","#CEA168","#90966A","#89C47C","#6A9A52","#E9787A","#DD4448","#A38CBD","#795FA3","#E0C880","#BA7D4F","#A65A35","#DE4B3F","#DA8F6F","#E66D52","#F6954A")
barplot(rep(1,length(colors.CD4)), col=colors.CD4, border = NA, space=0, axes=F)




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------




========================================
----------------------------------------

